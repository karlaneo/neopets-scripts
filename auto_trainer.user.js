// ==UserScript==
// @name         Neopets - Karla's Auto Trainer
// @namespace    karla@neopointskarla
// @license      GPL3
// @version      0.1.0
// @description  Automatically marks comic as read without hovering
// @author       Karla
// @match        *://*.neopets.com/pirates/academy.phtml?type=status*
// @match        *://*.neopets.com/island/training.phtml?type=status*
// @match        *://*.neopets.com/island/fight_training.phtml?type=status*
// @icon         https://github.com/karlaneo/neopets-scripts/blob/main/favicon-32x32.png?raw=true
// @grant        GM_getValue
// @grant        GM_setValue
// @downloadURL  https://github.com/karlaneo/neopets-scripts/raw/refs/heads/main/auto_trainer.user.js
// @updateURL    https://github.com/karlaneo/neopets-scripts/raw/refs/heads/main/auto_trainer.user.js
// ==/UserScript==

const a0_0x159963=a0_0x267e;function a0_0x267e(_0x21c94e,_0x49d464){const _0x3a68cd=a0_0x3a68();return a0_0x267e=function(_0x267e48,_0x1aeff2){_0x267e48=_0x267e48-0x7d;let _0x624610=_0x3a68cd[_0x267e48];return _0x624610;},a0_0x267e(_0x21c94e,_0x49d464);}(function(_0x93714e,_0x224a0a){const _0xc54d8f=a0_0x267e,_0x324494=_0x93714e();while(!![]){try{const _0x40b6cd=parseInt(_0xc54d8f(0x9e))/0x1+-parseInt(_0xc54d8f(0x82))/0x2*(parseInt(_0xc54d8f(0xac))/0x3)+-parseInt(_0xc54d8f(0x8f))/0x4+-parseInt(_0xc54d8f(0x100))/0x5*(parseInt(_0xc54d8f(0xab))/0x6)+parseInt(_0xc54d8f(0xa2))/0x7+parseInt(_0xc54d8f(0xa0))/0x8*(parseInt(_0xc54d8f(0x85))/0x9)+-parseInt(_0xc54d8f(0xbc))/0xa;if(_0x40b6cd===_0x224a0a)break;else _0x324494['push'](_0x324494['shift']());}catch(_0x33dcd4){_0x324494['push'](_0x324494['shift']());}}}(a0_0x3a68,0xf3fba));const settings=JSON['parse'](GM_getValue(a0_0x159963(0x90))||'{}');let startedPets=JSON[a0_0x159963(0xf5)](GM_getValue(a0_0x159963(0xf4))||'[]');const allPetState={},petStats={};let school;const petIntervals={},schoolName={'pirate':'Cap\x27n\x20Threelegs\x27\x20Swashbuckling\x20Academy','island':a0_0x159963(0xbe),'ninja':a0_0x159963(0xbf)},sleep=_0x1cc103=>new Promise(_0xca9fb2=>setTimeout(_0xca9fb2,_0x1cc103)),random_in_range=(_0x19e007,_0x1900d2)=>{const _0x35e9e3=a0_0x159963;return Math[_0x35e9e3(0xb8)](Math['random']()*(_0x1900d2-_0x19e007+0x1)+_0x19e007);};function parseTimeToMs(_0x3f21a0){const _0x3776da=a0_0x159963,_0x201f94=_0x3f21a0[_0x3776da(0xaa)](/(\d+)\s*hrs.*?(\d+)\s*minutes.*?(\d+)\s*seconds/i);if(!_0x201f94)return null;const _0x4f3e2a=Number(_0x201f94[0x1]),_0x3f38f4=Number(_0x201f94[0x2]),_0x148077=Number(_0x201f94[0x3]);return(_0x4f3e2a*0x3c*0x3c+_0x3f38f4*0x3c+_0x148077)*0x3e8;}function parseMsToTime(_0x31a28f){const _0x6dbebe=a0_0x159963,_0x535a64=Math['floor'](_0x31a28f/0x3e8),_0x10da65=Math[_0x6dbebe(0xb8)](_0x535a64/0xe10),_0xd7aeab=Math[_0x6dbebe(0xb8)](_0x535a64%0xe10/0x3c),_0x30e907=_0x535a64%0x3c;return _0x10da65+_0x6dbebe(0xe4)+_0xd7aeab+_0x6dbebe(0xcf)+_0x30e907+_0x6dbebe(0xcc);}async function buyItem(_0x57b70e){const _0x32fd0c=a0_0x159963;let _0x220d0c=[];for(let _0x27c321=0x0;_0x27c321<0x5;_0x27c321+=0x1){const _0x1ade4f=await fetch(_0x32fd0c(0xfc),{'headers':{'accept':'text/html,\x20*/*;\x20q=0.01','accept-language':_0x32fd0c(0xc4),'content-type':_0x32fd0c(0x84),'x-requested-with':_0x32fd0c(0xea)},'referrer':_0x32fd0c(0xa1),'referer':_0x32fd0c(0xa1),'referrerPolicy':'strict-origin-when-cross-origin','body':_0x32fd0c(0xc0)+encodeURIComponent(_0x57b70e)+_0x32fd0c(0x93),'method':_0x32fd0c(0x9b),'mode':_0x32fd0c(0xe9),'credentials':'include'})[_0x32fd0c(0xd5)](_0x36c536=>_0x36c536['text']());let _0x370068=new DOMParser(),_0x23bd4f=_0x370068['parseFromString'](_0x1ade4f,_0x32fd0c(0x87));if(_0x1ade4f[_0x32fd0c(0x10a)](_0x32fd0c(0xf9))){const _0x262fea=_0x23bd4f['querySelector'](_0x32fd0c(0xfb))[_0x32fd0c(0xca)],_0xf04003=Number(_0x262fea[_0x32fd0c(0xa9)](_0x32fd0c(0xa3),'')[_0x32fd0c(0xa9)]('\x20minutes\x20and\x20I\x20can\x20help\x20you\x20out.',''));if(_0x220d0c[_0x32fd0c(0xec)]>0x0)break;else{await sleep((_0xf04003+0x2)*0x3c*0x3e8),_0x27c321-=0x1;continue;}}const _0x12e4bb=_0x23bd4f[_0x32fd0c(0xc2)]('.wizard-results-grid\x20li:not(.wizard-results-grid-header)');for(let _0x48dd0d=0x0;_0x48dd0d<_0x12e4bb[_0x32fd0c(0xec)];_0x48dd0d+=0x1){const _0x555f11=_0x12e4bb[_0x48dd0d],_0x550fd1=Number(_0x555f11[_0x32fd0c(0xfd)]('.wizard-results-price')['textContent'][_0x32fd0c(0xba)]()['replace'](/,/g,'')[_0x32fd0c(0xa9)](_0x32fd0c(0xb3),'')),_0x19dff4=_0x555f11[_0x32fd0c(0xfd)]('a')[_0x32fd0c(0x8c)];!_0x220d0c[_0x32fd0c(0xce)](_0x2d6e4e=>_0x2d6e4e[_0x32fd0c(0xa7)]===_0x19dff4)&&_0x220d0c[_0x32fd0c(0x103)]({'price':_0x550fd1,'link':_0x19dff4});}_0x27c321===0x4&&!_0x220d0c['length']===0x0&&(_0x27c321-=0x1),await sleep(random_in_range(0x2bc,0x4b0));}_0x220d0c[_0x32fd0c(0xf1)]((_0x5dc9d8,_0x48c0af)=>_0x5dc9d8[_0x32fd0c(0x8e)]-_0x48c0af[_0x32fd0c(0x8e)]);for(let _0x2743ef=0x0;_0x2743ef<_0x220d0c[_0x32fd0c(0xec)];_0x2743ef+=0x1){const {link:_0x3b0728}=_0x220d0c[_0x2743ef],_0x35b8a2=await fetch(_0x3b0728,{'headers':{'accept':_0x32fd0c(0xb7),'Accept-Language':'en-US'},'referrer':'https://www.neopets.com/shops/wizard.phtml','referer':_0x32fd0c(0xa1),'referrerPolicy':_0x32fd0c(0xb1),'body':null,'method':'GET','mode':_0x32fd0c(0xe9),'credentials':_0x32fd0c(0xd6)})[_0x32fd0c(0xd5)](_0x23d3a6=>_0x23d3a6[_0x32fd0c(0xaf)]())[_0x32fd0c(0xe7)](_0x43aade=>({'error':_0x32fd0c(0xd7),'err':_0x43aade}));if(_0x35b8a2['includes'](_0x32fd0c(0x92)))continue;else{if(_0x35b8a2[_0x32fd0c(0x10a)](_0x32fd0c(0xe0))){await sleep(0x4b0,0x5dc);continue;}}let _0x3297a5=new DOMParser(),_0x4421cb=_0x3297a5[_0x32fd0c(0x101)](_0x35b8a2,'text/html');const _0x2847ba=_0x4421cb[_0x32fd0c(0xfd)](_0x32fd0c(0xe2))[_0x32fd0c(0xb0)]('href'),_0xbcb017=await fetch(_0x32fd0c(0x91)+_0x2847ba,{'headers':{'accept':_0x32fd0c(0xb7),'accept-language':_0x32fd0c(0xc4),'sec-ch-ua-mobile':'?0','sec-ch-ua-platform':_0x32fd0c(0xb5),'sec-fetch-dest':_0x32fd0c(0x8a),'sec-fetch-mode':_0x32fd0c(0xe8),'sec-fetch-site':'same-origin','sec-fetch-user':'?1','upgrade-insecure-requests':'1'},'referrer':_0x3b0728,'referer':_0x3b0728,'referrerPolicy':'strict-origin-when-cross-origin','body':null,'method':_0x32fd0c(0x94),'mode':_0x32fd0c(0xe9),'credentials':_0x32fd0c(0xd6)})[_0x32fd0c(0xd5)](_0x9f9b99=>_0x9f9b99[_0x32fd0c(0xaf)]())[_0x32fd0c(0xe7)](_0x4643fc=>({'error':_0x32fd0c(0xd7),'err':_0x4643fc}));if(_0xbcb017[_0x32fd0c(0x10a)](_0x32fd0c(0x88))){await sleep(0x4b0,0x5dc);continue;}break;}}function updateData(_0x57676f){const _0x4c649d=a0_0x159963;let _0x2c7a9b=new DOMParser(),_0x248cf9=_0x2c7a9b['parseFromString'](_0x57676f,'text/html');const _0xf427a9={'pirate':_0x4c649d(0x102),'island':_0x4c649d(0x83),'ninja':_0x4c649d(0x97)},_0x172c5c=_0x248cf9['querySelectorAll']('[width=\x22500\x22][align=\x22center\x22]\x20>\x20tbody\x20>\x20tr');for(let _0x48f61e=0x0;_0x48f61e<_0x172c5c[_0x4c649d(0xec)];_0x48f61e+=0x2){const _0x2b8925=_0x172c5c[_0x48f61e][_0x4c649d(0xca)][_0x4c649d(0x80)]('\x20')[0x0],_0x46c985=_0x172c5c[_0x48f61e+0x1][_0x4c649d(0xeb)],_0x2901ee={'lvl':Number(_0x46c985[_0x4c649d(0xaa)](/Lvl\s*:\s*.*?<b>(\d+)<\/b>/i)[0x1]),'str':Number(_0x46c985[_0x4c649d(0xaa)](/Str\s*:\s*<b>(\d+)<\/b>/i)[0x1]),'def':Number(_0x46c985[_0x4c649d(0xaa)](/Def\s*:\s*<b>(\d+)<\/b>/i)[0x1]),'mov':Number(_0x46c985['match'](/Mov\s*:\s*<b>(\d+)<\/b>/i)[0x1]),'hp':Number(_0x46c985[_0x4c649d(0xaa)](/Hp\s*:\s*<b>(\d+)\s*\/\s*(\d+)<\/b>/i)[0x2])};petStats[_0x2b8925]=_0x2901ee;const _0x5369f7=_0x172c5c[_0x48f61e+0x1][_0x4c649d(0xc2)]('td')[0x1][_0x4c649d(0xeb)];if(_0x5369f7[_0x4c649d(0x10a)]('value=\x22Complete\x20Course!\x22'))allPetState[_0x2b8925]={'state':0x3};else{if(_0x5369f7['startsWith'](_0x4c649d(0xdd)))allPetState[_0x2b8925]={'state':0x2,'timeLeft':parseTimeToMs(_0x5369f7)};else _0x5369f7[_0x4c649d(0x10a)](_0x4c649d(0x10c))||_0x5369f7[_0x4c649d(0x10a)](_0x4c649d(0xfe))?allPetState[_0x2b8925]={'state':0x1,'cost':Array['from'](_0x172c5c[_0x48f61e+0x1][_0x4c649d(0xc2)]('td')[0x1][_0x4c649d(0xc2)]('b'))[_0x4c649d(0xe6)](_0x3d498d=>_0x3d498d[_0x4c649d(0xca)])[_0x4c649d(0xb4)](_0x68a421=>_0x68a421[_0x4c649d(0x10a)](_0x4c649d(0x106))||_0x68a421[_0x4c649d(0x10a)](_0x4c649d(0xa6)))}:allPetState[_0x2b8925]={'state':0x0};}}}async function startTrainingPirate(){const _0x5937d5=a0_0x159963;let _0x3f8c9b=startedPets[_0x5937d5(0xce)](function(_0x33f648){const _0x523bd9=_0x5937d5;return allPetState[_0x33f648[_0x523bd9(0x7e)]]['state']!==0x4&&_0x33f648[_0x523bd9(0x7d)]===school;})?.[_0x5937d5(0x7e)]||'';while(!_0x3f8c9b){_0x3f8c9b=startedPets[_0x5937d5(0xce)](function(_0x2a7742){const _0x14ebd1=_0x5937d5;return allPetState[_0x2a7742[_0x14ebd1(0x7e)]][_0x14ebd1(0xc6)]!==0x4&&_0x2a7742[_0x14ebd1(0x7d)]===school;})?.[_0x5937d5(0x7e)]||'';if(_0x3f8c9b)break;await sleep(0x2710);}const _0x1d4045=petStats[_0x3f8c9b],_0x3be22e=allPetState[_0x3f8c9b],_0x59c56c=settings[_0x3f8c9b],_0x5072ae=document['querySelector'](_0x5937d5(0xa8)+_0x3f8c9b);if(_0x3be22e[_0x5937d5(0xc6)]===0x3){_0x5072ae['innerHTML']=_0x5937d5(0xc8);const _0x536b71=await fetch(_0x5937d5(0xa5),{'headers':{'accept':_0x5937d5(0xb7),'accept-language':_0x5937d5(0xe3),'cache-control':_0x5937d5(0xb2),'content-type':_0x5937d5(0x105)},'referrer':'https://www.neopets.com/pirates/academy.phtml?type=status','body':'type=complete&pet_name='+_0x3f8c9b,'method':'POST','mode':_0x5937d5(0xe9),'credentials':_0x5937d5(0xd6)})[_0x5937d5(0xd5)](_0x5389b7=>_0x5389b7[_0x5937d5(0xaf)]());await sleep(random_in_range(0x1f4,0x384));if(_0x536b71[_0x5937d5(0x10a)](_0x5937d5(0x104))){const _0x3b7d79=await fetch(_0x5937d5(0x102),{'headers':{'accept':_0x5937d5(0xb7),'accept-language':_0x5937d5(0xe3),'cache-control':_0x5937d5(0xb2)},'referrer':_0x5937d5(0x102),'body':null,'method':_0x5937d5(0x94),'mode':_0x5937d5(0xe9),'credentials':_0x5937d5(0xd6)})[_0x5937d5(0xd5)](_0x3247f1=>_0x3247f1['text']());updateData(_0x3b7d79);}}else{if(_0x3be22e['state']===0x2){let _0x4ce7aa=_0x3be22e['timeLeft'];_0x3be22e[_0x5937d5(0xc6)]=0x4;const _0x3992de=setInterval(async function(){const _0x7192d7=_0x5937d5;_0x5072ae[_0x7192d7(0xeb)]=parseMsToTime(_0x4ce7aa),_0x4ce7aa-=0x3e8;if(_0x4ce7aa<=0x0){const _0x579da2=await fetch('https://www.neopets.com/pirates/academy.phtml?type=status',{'headers':{'accept':_0x7192d7(0xb7),'accept-language':_0x7192d7(0xe3),'cache-control':_0x7192d7(0xb2)},'referrer':'https://www.neopets.com/pirates/academy.phtml?type=status','body':null,'method':_0x7192d7(0x94),'mode':_0x7192d7(0xe9),'credentials':_0x7192d7(0xd6)})[_0x7192d7(0xd5)](_0x5c688b=>_0x5c688b[_0x7192d7(0xaf)]());updateData(_0x579da2),clearInterval(_0x3992de);}},0x3e8);clearInterval(petIntervals[_0x3f8c9b]),petIntervals[_0x3f8c9b]=_0x3992de;}else{if(_0x3be22e[_0x5937d5(0xc6)]===0x1){_0x5072ae[_0x5937d5(0xeb)]=_0x5937d5(0x8d)+_0x3be22e[_0x5937d5(0xed)][0x0]+_0x5937d5(0xc1),await buyItem(_0x3be22e[_0x5937d5(0xed)][0x0]),await sleep(random_in_range(0x1f4,0x384)),_0x5072ae[_0x5937d5(0xeb)]=_0x5937d5(0xde);const _0x3fde75=await fetch(_0x5937d5(0xa5),{'headers':{'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','accept-language':_0x5937d5(0xe3),'cache-control':_0x5937d5(0xb2),'content-type':_0x5937d5(0x105)},'referrer':_0x5937d5(0x102),'body':_0x5937d5(0xe5)+_0x3f8c9b+_0x5937d5(0xda),'method':'POST','mode':_0x5937d5(0xe9),'credentials':_0x5937d5(0xd6)})[_0x5937d5(0xd5)](_0x328f6f=>_0x328f6f[_0x5937d5(0xaf)]());await updateData(_0x3fde75);}else{let _0x134aab=0x98967f,_0x358573=_0x5937d5(0x9a);_0x59c56c['hp']&&_0x1d4045['hp']<_0x134aab&&(_0x134aab=_0x1d4045['hp'],_0x358573='Endurance');_0x59c56c[_0x5937d5(0xd8)]&&_0x1d4045[_0x5937d5(0xd8)]<_0x134aab&&(_0x134aab=_0x1d4045[_0x5937d5(0xd8)],_0x358573='Strength');_0x59c56c[_0x5937d5(0x109)]&&_0x1d4045[_0x5937d5(0x109)]<_0x134aab&&(_0x134aab=_0x1d4045[_0x5937d5(0x109)],_0x358573='Defence');_0x59c56c[_0x5937d5(0xff)]&&_0x1d4045[_0x5937d5(0xff)]<_0x134aab&&(_0x134aab=_0x1d4045['mov'],_0x358573=_0x5937d5(0xd9));(_0x1d4045['hp']>_0x1d4045[_0x5937d5(0x98)]*0x2||_0x1d4045[_0x5937d5(0xd8)]>_0x1d4045[_0x5937d5(0x98)]*0x2||_0x1d4045[_0x5937d5(0x109)]>_0x1d4045['lvl']*0x2||_0x1d4045[_0x5937d5(0xff)]>_0x1d4045[_0x5937d5(0x98)]*0x2)&&(_0x358573=_0x5937d5(0x9a));_0x5072ae[_0x5937d5(0xeb)]=_0x5937d5(0xcd)+_0x358573+_0x5937d5(0xc1);const _0x112eed=await fetch(_0x5937d5(0xa5),{'headers':{'accept':_0x5937d5(0xb7),'accept-language':_0x5937d5(0xe3),'cache-control':_0x5937d5(0xb2),'content-type':_0x5937d5(0x105)},'referrer':'https://www.neopets.com/pirates/academy.phtml?type=courses','body':_0x5937d5(0x86)+_0x358573+_0x5937d5(0xd2)+_0x3f8c9b,'method':'POST','mode':_0x5937d5(0xe9),'credentials':_0x5937d5(0xd6)})[_0x5937d5(0xd5)](_0x51c018=>_0x51c018['text']());let _0x564629=new DOMParser(),_0x30f707=_0x564629[_0x5937d5(0x101)](_0x112eed,'text/html');_0x30f707['querySelector']('.errorMessage')?(_0x5072ae[_0x5937d5(0xeb)]=_0x30f707[_0x5937d5(0xfd)](_0x5937d5(0x81))[_0x5937d5(0xca)],startedPets=startedPets['filter'](_0xb0b79a=>_0xb0b79a[_0x5937d5(0x7e)]!==_0x3f8c9b),GM_setValue('started_pets',JSON['stringify'](startedPets))):updateData(_0x112eed);}}}await sleep(random_in_range(0x3e8,0x7d0)),startTrainingPirate();}async function startTrainingIsland(){const _0x2a9275=a0_0x159963;let _0x36b26c;while(!_0x36b26c){_0x36b26c=startedPets[_0x2a9275(0xce)](function(_0x1e19c8){const _0x3dcaa5=_0x2a9275;return allPetState[_0x1e19c8['petName']][_0x3dcaa5(0xc6)]!==0x4&&_0x1e19c8[_0x3dcaa5(0x7d)]===school;})?.['petName']||'';if(_0x36b26c)break;await sleep(0x2710);}const _0x21da24=petStats[_0x36b26c],_0x4fd688=allPetState[_0x36b26c],_0x4d5660=settings[_0x36b26c],_0x225896=document[_0x2a9275(0xfd)](_0x2a9275(0xa8)+_0x36b26c);if(_0x4fd688['state']===0x3){_0x225896[_0x2a9275(0xeb)]=_0x2a9275(0xc8);const _0x38b72a=await fetch('https://www.neopets.com/island/process_training.phtml',{'headers':{'accept':_0x2a9275(0xb7),'accept-language':_0x2a9275(0xe3),'cache-control':_0x2a9275(0xd3),'content-type':_0x2a9275(0x105)},'referrer':'https://www.neopets.com/island/training.phtml?type=status','body':'type=complete&pet_name='+_0x36b26c,'method':_0x2a9275(0x9b),'mode':_0x2a9275(0xe9),'credentials':_0x2a9275(0xd6)})[_0x2a9275(0xd5)](_0x431072=>_0x431072[_0x2a9275(0xaf)]());await sleep(random_in_range(0x1f4,0x384));if(_0x38b72a[_0x2a9275(0x10a)](_0x2a9275(0x104))){const _0x3451c2=await fetch(_0x2a9275(0x83),{'headers':{'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','accept-language':_0x2a9275(0xe3),'cache-control':_0x2a9275(0xb2)},'referrer':_0x2a9275(0x83),'body':null,'method':_0x2a9275(0x94),'mode':'cors','credentials':_0x2a9275(0xd6)})[_0x2a9275(0xd5)](_0x48efd6=>_0x48efd6[_0x2a9275(0xaf)]());updateData(_0x3451c2);}}else{if(_0x4fd688['state']===0x2){let _0x3b0514=_0x4fd688[_0x2a9275(0x9c)];_0x4fd688[_0x2a9275(0xc6)]=0x4,setTimeout(async function(){const _0x53d63a=_0x2a9275,_0x176b46=await fetch('https://www.neopets.com/island/training.phtml?type=status',{'headers':{'accept':_0x53d63a(0xb7),'accept-language':'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,zh-TW;q=0.6,es;q=0.5','cache-control':_0x53d63a(0xb2)},'referrer':_0x53d63a(0x83),'body':null,'method':_0x53d63a(0x94),'mode':_0x53d63a(0xe9),'credentials':'include'})[_0x53d63a(0xd5)](_0x576951=>_0x576951[_0x53d63a(0xaf)]());updateData(_0x176b46);},_0x3b0514);const _0x40b1cf=setInterval(function(){const _0x19977f=_0x2a9275;_0x225896[_0x19977f(0xeb)]=parseMsToTime(_0x3b0514),_0x3b0514-=0x3e8,_0x3b0514<=0x0&&clearInterval(_0x40b1cf);},0x3e8);clearInterval(petIntervals[_0x36b26c]),petIntervals[_0x36b26c]=_0x40b1cf;}else{if(_0x4fd688[_0x2a9275(0xc6)]===0x1){for(let _0x49b56c=0x0;_0x49b56c<_0x4fd688['cost'][_0x2a9275(0xec)];_0x49b56c+=0x1){_0x225896['innerHTML']=_0x2a9275(0x8d)+_0x4fd688['cost'][_0x49b56c]+_0x2a9275(0xc1),await buyItem(_0x4fd688[_0x2a9275(0xed)][_0x49b56c]),await sleep(random_in_range(0x5dc,0x9c4));}_0x225896['innerHTML']=_0x2a9275(0xde);const _0x2083cf=await fetch(_0x2a9275(0x95),{'headers':{'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','accept-language':_0x2a9275(0xe3),'cache-control':'max-age=0','content-type':_0x2a9275(0x105)},'referrer':_0x2a9275(0x83),'body':'pet_name='+_0x36b26c+_0x2a9275(0xda),'method':_0x2a9275(0x9b),'mode':_0x2a9275(0xe9),'credentials':'include'})['then'](_0x4e408a=>_0x4e408a[_0x2a9275(0xaf)]());await updateData(_0x2083cf);}else{let _0x5713da=0x98967f,_0x19dad2=_0x2a9275(0x9a);_0x4d5660['hp']&&_0x21da24['hp']<_0x5713da&&(_0x5713da=_0x21da24['hp'],_0x19dad2=_0x2a9275(0xee));_0x4d5660[_0x2a9275(0xd8)]&&_0x21da24['str']<_0x5713da&&(_0x5713da=_0x21da24[_0x2a9275(0xd8)],_0x19dad2='Strength');_0x4d5660['def']&&_0x21da24[_0x2a9275(0x109)]<_0x5713da&&(_0x5713da=_0x21da24[_0x2a9275(0x109)],_0x19dad2=_0x2a9275(0xdb));_0x4d5660[_0x2a9275(0xff)]&&_0x21da24[_0x2a9275(0xff)]<_0x5713da&&(_0x5713da=_0x21da24['mov'],_0x19dad2=_0x2a9275(0xd9));(_0x21da24['hp']>_0x21da24[_0x2a9275(0x98)]*0x2||_0x21da24[_0x2a9275(0xd8)]>_0x21da24[_0x2a9275(0x98)]*0x2||_0x21da24[_0x2a9275(0x109)]>_0x21da24[_0x2a9275(0x98)]*0x2||_0x21da24[_0x2a9275(0xff)]>_0x21da24['lvl']*0x2)&&(_0x19dad2='Level');_0x225896[_0x2a9275(0xeb)]='Staring\x20course\x20in\x20'+_0x19dad2+_0x2a9275(0xc1);const _0x267560=await fetch(_0x2a9275(0x95),{'headers':{'accept':_0x2a9275(0xb7),'accept-language':'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,zh-TW;q=0.6,es;q=0.5','cache-control':'max-age=0','content-type':_0x2a9275(0x105)},'referrer':'https://www.neopets.com/island/training.phtml?type=courses','body':_0x2a9275(0x86)+_0x19dad2+_0x2a9275(0xd2)+_0x36b26c,'method':_0x2a9275(0x9b),'mode':_0x2a9275(0xe9),'credentials':_0x2a9275(0xd6)})['then'](_0x19b37a=>_0x19b37a['text']());let _0x158443=new DOMParser(),_0x88638e=_0x158443[_0x2a9275(0x101)](_0x267560,'text/html');_0x88638e[_0x2a9275(0xfd)]('.errorMessage')?(_0x225896[_0x2a9275(0xeb)]=_0x88638e['querySelector']('.errorMessage')[_0x2a9275(0xca)],startedPets=startedPets[_0x2a9275(0xb4)](_0x2fa8f1=>_0x2fa8f1[_0x2a9275(0x7e)]!==_0x36b26c),GM_setValue(_0x2a9275(0xf4),JSON[_0x2a9275(0xd0)](startedPets))):updateData(_0x267560);}}}await sleep(random_in_range(0x3e8,0x7d0)),startTrainingIsland();}function a0_0x3a68(){const _0x4128f1=['Item\x20not\x20found!','&table=shop&criteria=exact&min_price=0&max_price=999999','GET','https://www.neopets.com/island/process_training.phtml','append','https://www.neopets.com/island/fight_training.phtml?type=status','lvl','</button>\x0a</div>','Level','POST','timeLeft','[name=\x22hp\x22]','853646BKPved','[name=\x22def\x22]','1422728YqwEuO','https://www.neopets.com/shops/wizard.phtml','9518068hQXxNc','I\x20am\x20too\x20busy\x20right\x20now,\x20please\x20come\x20back\x20in\x20about\x20','target','https://www.neopets.com/pirates/process_academy.phtml','Dubloon','link','#panel_','replace','match','76926paFaXf','57mQKCAI','Training\x20at\x20','ninja','text','getAttribute','strict-origin-when-cross-origin','no-cache','\x20NP','filter','\x22Windows\x22','Stop','text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','floor','createElement','trim','disabled','6327770PjgUJy','https://www.neopets.com/island/process_fight_training.phtml','Mystery\x20Island\x20Training\x20School','Secret\x20Ninja\x20Training\x20School','type=process_wizard&feedset=0&shopwizard=','...','querySelectorAll','\x20/>\x20Mov</label>\x0a\x20\x20<br\x20/>\x0a\x20\x20<button\x20style=\x22margin-top:\x208px\x22>','en-US','outerHTML','state','startsWith','Finishing\x20course...','documentElement','textContent','pathname','\x20seconds','Staring\x20course\x20in\x20','find','\x20minutes,\x20','stringify','island','&pet_name=','max-age=0','log','then','include','error','str','Agility','&type=pay','Defence','div','Time\x20till\x20course\x20finishes','Paying\x20for\x20course...','/pirates/academy.phtml','Sorry\x20-\x20The\x20owner\x20of\x20this\x20shop\x20has\x20been\x20frozen!','\x20/>\x20Hp</label>\x0a\x20\x20<label><input\x20name=\x22str\x22\x20type=\x22checkbox\x22\x20','a[href^=\x22buy_item.phtml\x22]','en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,zh-TW;q=0.6,es;q=0.5','\x20hrs,\x20','pet_name=','map','catch','navigate','cors','XMLHttpRequest','innerHTML','length','cost','Endurance','addEventListener','checked','sort','forEach','change','started_pets','parse','name','panel_','\x0a<div>--\x20Auto\x20Train\x20Stats\x20--</div>\x0a\x20\x20<div\x20style=\x22margin-top:\x208px\x22>\x0a\x20\x20<label><input\x20name=\x22hp\x22\x20type=\x22checkbox\x22\x20','Whoa\x20there,\x20too\x20many\x20searches!','Start','.wizard-char.wizard-char-single.wizard-char-old\x20+\x20p\x20+\x20p','https://www.neopets.com/np-templates/ajax/wizard.php','querySelector','This\x20course\x20has\x20not\x20been\x20paid\x20for\x20yet','mov','355mLBaxr','parseFromString','https://www.neopets.com/pirates/academy.phtml?type=status','push','Congratulations','application/x-www-form-urlencoded','Codestone','[name=\x22str\x22]','click','def','includes','[width=\x22500\x22][align=\x22center\x22]\x20>\x20tbody\x20>\x20tr','value=\x22Pay\x22','school','petName','/island/fight_training.phtml','split','.errorMessage','56846OKZGFI','https://www.neopets.com/island/training.phtml?type=status','application/x-www-form-urlencoded;\x20charset=UTF-8','90FFrUWA','type=start&course_type=','text/html','The\x20item\x20you\x20are\x20trying\x20to\x20buy\x20does\x20not\x20exist\x20in\x20this\x20shop!','https://www.neopets.com/island/fight_training.phtml?type=courses','document','u=0,\x20i','href','Buying\x20','price','3637284qfkKxI','settings','https://www.neopets.com/'];a0_0x3a68=function(){return _0x4128f1;};return a0_0x3a68();}async function startTrainingNinja(){const _0x3bdd4e=a0_0x159963,_0x150edb=startedPets[_0x3bdd4e(0xce)](function(_0x5642d2){const _0x2bca13=_0x3bdd4e;return allPetState[_0x5642d2[_0x2bca13(0x7e)]]?.[_0x2bca13(0xc6)]!==0x4&&_0x5642d2[_0x2bca13(0x7d)]===school;})?.['petName']||'';while(!_0x150edb){await sleep(0x2710);}const _0x52e4e5=petStats[_0x150edb],_0x314c20=allPetState[_0x150edb],_0x5c0fe1=settings[_0x150edb],_0x21b9ff=document[_0x3bdd4e(0xfd)](_0x3bdd4e(0xa8)+_0x150edb);if(_0x314c20[_0x3bdd4e(0xc6)]===0x3){_0x21b9ff[_0x3bdd4e(0xeb)]=_0x3bdd4e(0xc8);const _0x3e952d=await await fetch(_0x3bdd4e(0xbd),{'headers':{'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','accept-language':_0x3bdd4e(0xe3),'cache-control':'max-age=0','content-type':_0x3bdd4e(0x105)},'referrer':_0x3bdd4e(0x83),'body':'type=complete&pet_name='+_0x150edb,'method':_0x3bdd4e(0x9b),'mode':_0x3bdd4e(0xe9),'credentials':'include'})[_0x3bdd4e(0xd5)](_0x5900da=>_0x5900da[_0x3bdd4e(0xaf)]());await sleep(random_in_range(0x1f4,0x384));if(_0x3e952d[_0x3bdd4e(0x10a)]('Congratulations')){const _0x11e95e=await fetch(_0x3bdd4e(0x97),{'headers':{'accept':_0x3bdd4e(0xb7),'accept-language':_0x3bdd4e(0xe3),'priority':_0x3bdd4e(0x8b)},'referrer':_0x3bdd4e(0x97),'body':null,'method':_0x3bdd4e(0x94),'mode':'cors','credentials':_0x3bdd4e(0xd6)})['then'](_0x4dc34c=>_0x4dc34c['text']());updateData(_0x11e95e);}}else{if(_0x314c20[_0x3bdd4e(0xc6)]===0x2){let _0x21e809=_0x314c20['timeLeft'];_0x314c20[_0x3bdd4e(0xc6)]=0x4;const _0x111986=setInterval(async function(){const _0x5affb9=_0x3bdd4e;_0x21b9ff[_0x5affb9(0xeb)]=parseMsToTime(_0x21e809),_0x21e809-=0x3e8;if(_0x21e809<=0x0){const _0x44687b=await fetch(_0x5affb9(0x97),{'headers':{'accept':_0x5affb9(0xb7),'accept-language':_0x5affb9(0xe3),'cache-control':_0x5affb9(0xb2)},'referrer':'https://www.neopets.com/island/fight_training.phtml?type=status','body':null,'method':_0x5affb9(0x94),'mode':_0x5affb9(0xe9),'credentials':_0x5affb9(0xd6)})['then'](_0x6df5ae=>_0x6df5ae['text']());updateData(_0x44687b),clearInterval(_0x111986);}},0x3e8);clearInterval(petIntervals[_0x150edb]),petIntervals[_0x150edb]=_0x111986;}else{if(_0x314c20[_0x3bdd4e(0xc6)]===0x1){for(let _0x58c426=0x0;_0x58c426<_0x314c20['cost'][_0x3bdd4e(0xec)];_0x58c426+=0x1){_0x21b9ff[_0x3bdd4e(0xeb)]=_0x3bdd4e(0x8d)+_0x314c20['cost'][_0x58c426]+_0x3bdd4e(0xc1),await buyItem(_0x314c20[_0x3bdd4e(0xed)][_0x58c426]),await sleep(random_in_range(0x1f4,0x384));}_0x21b9ff['innerHTML']=_0x3bdd4e(0xde);const _0x53e401=await fetch(_0x3bdd4e(0xbd),{'headers':{'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','accept-language':'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,zh-TW;q=0.6,es;q=0.5','cache-control':'max-age=0','content-type':'application/x-www-form-urlencoded'},'referrer':_0x3bdd4e(0x83),'body':_0x3bdd4e(0xe5)+_0x150edb+'&type=pay','method':_0x3bdd4e(0x9b),'mode':_0x3bdd4e(0xe9),'credentials':'include'})[_0x3bdd4e(0xd5)](_0x238525=>_0x238525['text']());await updateData(_0x53e401);}else{let _0x469ca3=0x98967f,_0x14460a=_0x3bdd4e(0x9a);_0x5c0fe1['hp']&&_0x52e4e5['hp']<_0x469ca3&&(_0x469ca3=_0x52e4e5['hp'],_0x14460a=_0x3bdd4e(0xee));_0x5c0fe1[_0x3bdd4e(0xd8)]&&_0x52e4e5[_0x3bdd4e(0xd8)]<_0x469ca3&&(_0x469ca3=_0x52e4e5['str'],_0x14460a='Strength');_0x5c0fe1[_0x3bdd4e(0x109)]&&_0x52e4e5['def']<_0x469ca3&&(_0x469ca3=_0x52e4e5[_0x3bdd4e(0x109)],_0x14460a=_0x3bdd4e(0xdb));_0x5c0fe1[_0x3bdd4e(0xff)]&&_0x52e4e5[_0x3bdd4e(0xff)]<_0x469ca3&&(_0x469ca3=_0x52e4e5[_0x3bdd4e(0xff)],_0x14460a='Agility');(_0x52e4e5['hp']>_0x52e4e5[_0x3bdd4e(0x98)]*0x2||_0x52e4e5[_0x3bdd4e(0xd8)]>_0x52e4e5[_0x3bdd4e(0x98)]*0x2||_0x52e4e5[_0x3bdd4e(0x109)]>_0x52e4e5[_0x3bdd4e(0x98)]*0x2||_0x52e4e5[_0x3bdd4e(0xff)]>_0x52e4e5[_0x3bdd4e(0x98)]*0x2)&&(_0x14460a=_0x3bdd4e(0x9a));_0x21b9ff[_0x3bdd4e(0xeb)]='Staring\x20course\x20in\x20'+_0x14460a+_0x3bdd4e(0xc1);const _0x5dae17=await fetch(_0x3bdd4e(0xbd),{'headers':{'accept':_0x3bdd4e(0xb7),'accept-language':_0x3bdd4e(0xe3),'cache-control':_0x3bdd4e(0xd3),'content-type':_0x3bdd4e(0x105)},'referrer':_0x3bdd4e(0x89),'body':_0x3bdd4e(0x86)+_0x14460a+_0x3bdd4e(0xd2)+_0x150edb,'method':_0x3bdd4e(0x9b),'mode':'cors','credentials':_0x3bdd4e(0xd6)})[_0x3bdd4e(0xd5)](_0x3da35e=>_0x3da35e[_0x3bdd4e(0xaf)]());let _0x28ea5a=new DOMParser(),_0x1252d2=_0x28ea5a[_0x3bdd4e(0x101)](_0x5dae17,_0x3bdd4e(0x87));_0x1252d2[_0x3bdd4e(0xfd)](_0x3bdd4e(0x81))?(_0x21b9ff[_0x3bdd4e(0xeb)]=_0x1252d2[_0x3bdd4e(0xfd)](_0x3bdd4e(0x81))[_0x3bdd4e(0xca)],startedPets=startedPets[_0x3bdd4e(0xb4)](_0x2ea03e=>_0x2ea03e[_0x3bdd4e(0x7e)]!==_0x150edb),GM_setValue(_0x3bdd4e(0xf4),JSON[_0x3bdd4e(0xd0)](startedPets))):updateData(_0x5dae17);}}}await sleep(random_in_range(0x3e8,0x7d0)),startTrainingNinja();}function getStatPanel(_0x30f2ea){const _0xe9faec=a0_0x159963,_0x1e3f7d=petStats[_0x30f2ea],_0x56e346=startedPets[_0xe9faec(0xce)](_0x4fb1a4=>_0x4fb1a4[_0xe9faec(0x7e)]===_0x30f2ea),_0x15ea66=settings[_0x30f2ea],_0x31c366=document['createElement'](_0xe9faec(0xdc));if(!_0x56e346||_0x56e346[_0xe9faec(0x7d)]===school){_0x31c366[_0xe9faec(0xeb)]=_0xe9faec(0xf8)+(_0x56e346?_0xe9faec(0xbb):'')+_0xe9faec(0xe1)+(_0x56e346?_0xe9faec(0xbb):'')+'\x20/>\x20Str</label>\x0a\x20\x20<label><input\x20name=\x22def\x22\x20type=\x22checkbox\x22\x20'+(_0x56e346?_0xe9faec(0xbb):'')+'\x20/>\x20Def</label>\x0a\x20\x20<label><input\x20name=\x22mov\x22\x20type=\x22checkbox\x22\x20'+(_0x56e346?_0xe9faec(0xbb):'')+_0xe9faec(0xc3)+(_0x56e346?'Stop':_0xe9faec(0xfa))+_0xe9faec(0x99);const _0x49ddcb=_0x31c366[_0xe9faec(0xfd)](_0xe9faec(0x9d)),_0x22d3da=_0x31c366['querySelector'](_0xe9faec(0x107)),_0x13668a=_0x31c366['querySelector'](_0xe9faec(0x9f)),_0x5b393e=_0x31c366[_0xe9faec(0xfd)]('[name=\x22mov\x22]');[_0x49ddcb,_0x22d3da,_0x13668a,_0x5b393e][_0xe9faec(0xf2)](function(_0x30dae2){const _0x3c4196=_0xe9faec;_0x30dae2[_0x3c4196(0xf0)]=_0x15ea66[_0x30dae2[_0x3c4196(0xb0)](_0x3c4196(0xf6))],_0x30dae2[_0x3c4196(0xef)](_0x3c4196(0xf3),function(_0x144d9a){const _0x3e2bc1=_0x3c4196;_0x15ea66[_0x144d9a[_0x3e2bc1(0xa4)][_0x3e2bc1(0xb0)](_0x3e2bc1(0xf6))]=_0x144d9a[_0x3e2bc1(0xa4)][_0x3e2bc1(0xf0)],GM_setValue(_0x3e2bc1(0x90),JSON[_0x3e2bc1(0xd0)](settings));});});const _0x2f9e94=_0x31c366[_0xe9faec(0xfd)]('button');_0x2f9e94[_0xe9faec(0xef)](_0xe9faec(0x108),function(){const _0x51c22a=_0xe9faec;!startedPets[_0x51c22a(0xce)](_0x130309=>_0x130309['petName']===_0x30f2ea&&_0x130309['school']===school)?(_0x2f9e94['disabled']=!![],_0x2f9e94[_0x51c22a(0xeb)]=_0x51c22a(0xb6),_0x49ddcb[_0x51c22a(0xbb)]=!![],_0x22d3da[_0x51c22a(0xbb)]=!![],_0x13668a['disabled']=!![],_0x5b393e[_0x51c22a(0xbb)]=!![],startedPets[_0x51c22a(0x103)]({'petName':_0x30f2ea,'school':school})):(_0x2f9e94[_0x51c22a(0xbb)]=![],_0x2f9e94[_0x51c22a(0xeb)]=_0x51c22a(0xfa),_0x49ddcb[_0x51c22a(0xbb)]=![],_0x22d3da[_0x51c22a(0xbb)]=![],_0x13668a[_0x51c22a(0xbb)]=![],_0x5b393e['disabled']=![],startedPets=startedPets[_0x51c22a(0xb4)](_0x1c53e9=>_0x1c53e9['petName']!==_0x30f2ea)),GM_setValue(_0x51c22a(0xf4),JSON[_0x51c22a(0xd0)](startedPets));});}else _0x31c366['innerHTML']=_0xe9faec(0xad)+schoolName[_0x56e346[_0xe9faec(0x7d)]];return _0x31c366;}(async function(){'use strict';const _0x374e53=a0_0x159963;try{const _0x4abdbe=document[_0x374e53(0xc9)][_0x374e53(0xc5)];if(location[_0x374e53(0xcb)][_0x374e53(0xc7)](_0x374e53(0xdf))){school='pirate';const _0x73c530=document[_0x374e53(0xc2)](_0x374e53(0x10b));for(let _0x4f4e74=0x0;_0x4f4e74<_0x73c530[_0x374e53(0xec)];_0x4f4e74+=0x2){const _0x3c2e7c=_0x73c530[_0x4f4e74][_0x374e53(0xca)][_0x374e53(0x80)]('\x20')[0x0];!settings[_0x3c2e7c]&&(settings[_0x3c2e7c]={'hp':![],'str':![],'def':![],'mov':![]},GM_setValue('settings',JSON[_0x374e53(0xd0)](settings)));const _0x3b560c=getStatPanel(_0x3c2e7c);_0x73c530[_0x4f4e74+0x1]['querySelectorAll']('td')[0x1][_0x374e53(0xeb)]='',_0x73c530[_0x4f4e74+0x1][_0x374e53(0xc2)]('td')[0x1]['append'](_0x3b560c);const _0x170a3a=document['createElement'](_0x374e53(0xdc));_0x170a3a['id']=_0x374e53(0xf7)+_0x3c2e7c,_0x73c530[_0x4f4e74+0x1][_0x374e53(0xc2)]('td')[0x1][_0x374e53(0x96)](_0x170a3a);}updateData(_0x4abdbe),startTrainingPirate();}else{if(location[_0x374e53(0xcb)][_0x374e53(0xc7)]('/island/training.phtml')){school=_0x374e53(0xd1);const _0x57b31c=document['querySelectorAll'](_0x374e53(0x10b));for(let _0x4b270e=0x0;_0x4b270e<_0x57b31c[_0x374e53(0xec)];_0x4b270e+=0x2){const _0x271109=_0x57b31c[_0x4b270e][_0x374e53(0xca)][_0x374e53(0x80)]('\x20')[0x0];!settings[_0x271109]&&(settings[_0x271109]={'hp':![],'str':![],'def':![],'mov':![]},GM_setValue('settings',JSON[_0x374e53(0xd0)](settings)));const _0x1d74c2=getStatPanel(_0x271109);_0x57b31c[_0x4b270e+0x1][_0x374e53(0xc2)]('td')[0x1][_0x374e53(0xeb)]='',_0x57b31c[_0x4b270e+0x1]['querySelectorAll']('td')[0x1][_0x374e53(0x96)](_0x1d74c2);const _0x9a54ef=document[_0x374e53(0xb9)]('div');_0x9a54ef['id']='panel_'+_0x271109,_0x57b31c[_0x4b270e+0x1][_0x374e53(0xc2)]('td')[0x1][_0x374e53(0x96)](_0x9a54ef);}updateData(_0x4abdbe),startTrainingIsland();}else{if(location['pathname'][_0x374e53(0xc7)](_0x374e53(0x7f))){school=_0x374e53(0xae);const _0x4648a8=document[_0x374e53(0xc2)](_0x374e53(0x10b));for(let _0x226592=0x0;_0x226592<_0x4648a8['length'];_0x226592+=0x2){const _0x434f74=_0x4648a8[_0x226592][_0x374e53(0xca)][_0x374e53(0x80)]('\x20')[0x0];!settings[_0x434f74]&&(settings[_0x434f74]={'hp':![],'str':![],'def':![],'mov':![]},GM_setValue('settings',JSON[_0x374e53(0xd0)](settings)));const _0x15f267=getStatPanel(_0x434f74);_0x4648a8[_0x226592+0x1][_0x374e53(0xc2)]('td')[0x1][_0x374e53(0xeb)]='',_0x4648a8[_0x226592+0x1][_0x374e53(0xc2)]('td')[0x1][_0x374e53(0x96)](_0x15f267);const _0x339b09=document[_0x374e53(0xb9)](_0x374e53(0xdc));_0x339b09['id']=_0x374e53(0xf7)+_0x434f74,_0x4648a8[_0x226592+0x1][_0x374e53(0xc2)]('td')[0x1][_0x374e53(0x96)](_0x339b09);}updateData(_0x4abdbe),startTrainingNinja();}}}}catch(_0x2a91de){console[_0x374e53(0xd4)](_0x2a91de);}}());
