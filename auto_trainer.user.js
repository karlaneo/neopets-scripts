// ==UserScript==
// @name         Neopets - Karla's Auto Trainer
// @namespace    karla@neopointskarla
// @license      GPL3
// @version      0.0.1
// @description  Automatically marks comic as read without hovering
// @author       Karla
// @match        *://*.neopets.com/pirates/academy.phtml?type=status*
// @match        *://*.neopets.com/island/training.phtml?type=status*
// @match        *://*.neopets.com/island/fight_training.phtml?type=status*
// @icon         https://github.com/karlaneo/neopets-scripts/blob/main/favicon-32x32.png?raw=true
// @grant        GM_getValue
// @grant        GM_setValue
// @downloadURL  https://github.com/karlaneo/neopets-scripts/raw/refs/heads/main/auto_trainer.user.js
// @updateURL    https://github.com/karlaneo/neopets-scripts/raw/refs/heads/main/auto_trainer.user.js
// ==/UserScript==

const a0_0x2d1ea6=a0_0x31fc;(function(_0x5b6beb,_0x483d44){const _0x57382d=a0_0x31fc,_0x155c08=_0x5b6beb();while(!![]){try{const _0x5c6dfb=-parseInt(_0x57382d(0x15c))/0x1+parseInt(_0x57382d(0x115))/0x2+-parseInt(_0x57382d(0x133))/0x3+parseInt(_0x57382d(0x126))/0x4+parseInt(_0x57382d(0x128))/0x5+-parseInt(_0x57382d(0x140))/0x6*(-parseInt(_0x57382d(0x117))/0x7)+-parseInt(_0x57382d(0x125))/0x8;if(_0x5c6dfb===_0x483d44)break;else _0x155c08['push'](_0x155c08['shift']());}catch(_0x39fdb8){_0x155c08['push'](_0x155c08['shift']());}}}(a0_0x1648,0x42b95));const settings=JSON['parse'](GM_getValue('settings')||'{}');let startedPets=JSON[a0_0x2d1ea6(0x153)](GM_getValue('started_pets')||'[]');const allPetState={},petStats={};let school;const petIntervals={},schoolName={'pirate':a0_0x2d1ea6(0x114),'island':a0_0x2d1ea6(0x124),'ninja':a0_0x2d1ea6(0x137)},sleep=_0x4c410e=>new Promise(_0x25e3ed=>setTimeout(_0x25e3ed,_0x4c410e)),random_in_range=(_0x32b304,_0x2f2b79)=>{const _0x198249=a0_0x2d1ea6;return Math[_0x198249(0x10c)](Math['random']()*(_0x2f2b79-_0x32b304+0x1)+_0x32b304);};function parseTimeToMs(_0x4ba56f){const _0x240677=a0_0x2d1ea6,_0x334771=_0x4ba56f[_0x240677(0x129)](/(\d+)\s*hrs.*?(\d+)\s*minutes.*?(\d+)\s*seconds/i);if(!_0x334771)return null;const _0x522a08=Number(_0x334771[0x1]),_0x2aec2b=Number(_0x334771[0x2]),_0x54fbf1=Number(_0x334771[0x3]);return(_0x522a08*0x3c*0x3c+_0x2aec2b*0x3c+_0x54fbf1)*0x3e8;}function a0_0x31fc(_0x35db08,_0x14b73b){const _0x164843=a0_0x1648();return a0_0x31fc=function(_0x31fc54,_0x4da795){_0x31fc54=_0x31fc54-0x103;let _0x58f308=_0x164843[_0x31fc54];return _0x58f308;},a0_0x31fc(_0x35db08,_0x14b73b);}function parseMsToTime(_0xa4f9c){const _0x3df26e=a0_0x2d1ea6,_0x425744=Math[_0x3df26e(0x10c)](_0xa4f9c/0x3e8),_0x28a72a=Math[_0x3df26e(0x10c)](_0x425744/0xe10),_0x2ead51=Math[_0x3df26e(0x10c)](_0x425744%0xe10/0x3c),_0x1181be=_0x425744%0x3c;return _0x28a72a+_0x3df26e(0x11c)+_0x2ead51+_0x3df26e(0x11f)+_0x1181be+_0x3df26e(0x182);}async function buyItem(_0x39152d){const _0x4b7a77=a0_0x2d1ea6;let _0x356977=[];for(let _0xd442de=0x0;_0xd442de<0x5;_0xd442de+=0x1){const _0x45f8d3=await fetch(_0x4b7a77(0x119),{'headers':{'accept':_0x4b7a77(0x161),'accept-language':_0x4b7a77(0x118),'content-type':_0x4b7a77(0x108),'x-requested-with':'XMLHttpRequest'},'referrer':'https://www.neopets.com/shops/wizard.phtml','referer':_0x4b7a77(0x142),'referrerPolicy':'strict-origin-when-cross-origin','body':_0x4b7a77(0x189)+encodeURIComponent(_0x39152d)+_0x4b7a77(0x186),'method':_0x4b7a77(0x17d),'mode':'cors','credentials':_0x4b7a77(0x164)})['then'](_0x3b91b1=>_0x3b91b1[_0x4b7a77(0x188)]());let _0x235c94=new DOMParser(),_0xd336af=_0x235c94['parseFromString'](_0x45f8d3,_0x4b7a77(0x17c));if(_0x45f8d3[_0x4b7a77(0x148)]('Whoa\x20there,\x20too\x20many\x20searches!')){const _0x9c939=_0xd336af[_0x4b7a77(0x12e)](_0x4b7a77(0x11d))[_0x4b7a77(0x18a)],_0x509ab2=Number(_0x9c939['replace'](_0x4b7a77(0x13d),'')['replace'](_0x4b7a77(0x169),''));if(_0x356977['length']>0x0)break;else{await sleep((_0x509ab2+0x2)*0x3c*0x3e8),_0xd442de-=0x1;continue;}}const _0x1783c0=_0xd336af[_0x4b7a77(0x160)](_0x4b7a77(0x156));for(let _0x577805=0x0;_0x577805<_0x1783c0[_0x4b7a77(0x11b)];_0x577805+=0x1){const _0x49c0fb=_0x1783c0[_0x577805],_0x313ddb=Number(_0x49c0fb[_0x4b7a77(0x12e)](_0x4b7a77(0x10d))[_0x4b7a77(0x18a)][_0x4b7a77(0x14e)]()['replace'](/,/g,'')[_0x4b7a77(0x12b)](_0x4b7a77(0x163),'')),_0x149963=_0x49c0fb[_0x4b7a77(0x12e)]('a')[_0x4b7a77(0x135)];!_0x356977[_0x4b7a77(0x168)](_0x2af79f=>_0x2af79f[_0x4b7a77(0x10b)]===_0x149963)&&_0x356977[_0x4b7a77(0x16a)]({'price':_0x313ddb,'link':_0x149963});}_0xd442de===0x4&&!_0x356977[_0x4b7a77(0x11b)]===0x0&&(_0xd442de-=0x1),await sleep(random_in_range(0x2bc,0x4b0));}_0x356977['sort']((_0x3a3a03,_0x494a0f)=>_0x3a3a03[_0x4b7a77(0x123)]-_0x494a0f[_0x4b7a77(0x123)]);for(let _0x48a724=0x0;_0x48a724<_0x356977[_0x4b7a77(0x11b)];_0x48a724+=0x1){const {link:_0x2e21a4}=_0x356977[_0x48a724],_0x578151=await fetch(_0x2e21a4,{'headers':{'accept':_0x4b7a77(0x167),'Accept-Language':_0x4b7a77(0x118)},'referrer':_0x4b7a77(0x142),'referer':'https://www.neopets.com/shops/wizard.phtml','referrerPolicy':_0x4b7a77(0x16f),'body':null,'method':_0x4b7a77(0x14d),'mode':'cors','credentials':_0x4b7a77(0x164)})['then'](_0x5d6c2a=>_0x5d6c2a[_0x4b7a77(0x188)]())[_0x4b7a77(0x10f)](_0x21a329=>({'error':'error','err':_0x21a329}));if(_0x578151[_0x4b7a77(0x148)](_0x4b7a77(0x15b)))continue;else{if(_0x578151['includes'](_0x4b7a77(0x15f))){await sleep(0x4b0,0x5dc);continue;}}let _0x19e783=new DOMParser(),_0x4ac727=_0x19e783['parseFromString'](_0x578151,_0x4b7a77(0x17c));const _0x1d2c60=_0x4ac727['querySelector']('a[href^=\x22buy_item.phtml\x22]')[_0x4b7a77(0x15e)]('href'),_0x201558=await fetch('https://www.neopets.com/'+_0x1d2c60,{'headers':{'accept':_0x4b7a77(0x167),'accept-language':_0x4b7a77(0x118),'sec-ch-ua-mobile':'?0','sec-ch-ua-platform':_0x4b7a77(0x17e),'sec-fetch-dest':'document','sec-fetch-mode':_0x4b7a77(0x110),'sec-fetch-site':_0x4b7a77(0x12c),'sec-fetch-user':'?1','upgrade-insecure-requests':'1'},'referrer':_0x2e21a4,'referer':_0x2e21a4,'referrerPolicy':_0x4b7a77(0x16f),'body':null,'method':_0x4b7a77(0x14d),'mode':_0x4b7a77(0x109),'credentials':_0x4b7a77(0x164)})['then'](_0x2efda6=>_0x2efda6[_0x4b7a77(0x188)]())[_0x4b7a77(0x10f)](_0x506f54=>({'error':_0x4b7a77(0x13a),'err':_0x506f54}));if(_0x201558[_0x4b7a77(0x148)](_0x4b7a77(0x165))){await sleep(0x4b0,0x5dc);continue;}break;}}function updateData(_0x5f5351){const _0x103207=a0_0x2d1ea6;let _0x475a5d=new DOMParser(),_0x4c12ec=_0x475a5d[_0x103207(0x12d)](_0x5f5351,'text/html');const _0x51f25c={'pirate':_0x103207(0x157),'island':_0x103207(0x18d),'ninja':_0x103207(0x14c)},_0x3463a4=_0x4c12ec[_0x103207(0x160)]('[width=\x22500\x22][align=\x22center\x22]\x20>\x20tbody\x20>\x20tr');for(let _0x2ce607=0x0;_0x2ce607<_0x3463a4[_0x103207(0x11b)];_0x2ce607+=0x2){const _0x1eb305=_0x3463a4[_0x2ce607][_0x103207(0x18a)]['split']('\x20')[0x0],_0x5d4bd5=_0x3463a4[_0x2ce607+0x1][_0x103207(0x145)],_0x4aa347={'lvl':Number(_0x5d4bd5[_0x103207(0x129)](/Lvl\s*:\s*.*?<b>(\d+)<\/b>/i)[0x1]),'str':Number(_0x5d4bd5[_0x103207(0x129)](/Str\s*:\s*<b>(\d+)<\/b>/i)[0x1]),'def':Number(_0x5d4bd5[_0x103207(0x129)](/Def\s*:\s*<b>(\d+)<\/b>/i)[0x1]),'mov':Number(_0x5d4bd5[_0x103207(0x129)](/Mov\s*:\s*<b>(\d+)<\/b>/i)[0x1]),'hp':Number(_0x5d4bd5['match'](/Hp\s*:\s*<b>(\d+)\s*\/\s*(\d+)<\/b>/i)[0x2])};petStats[_0x1eb305]=_0x4aa347;const _0x2f80c2=_0x3463a4[_0x2ce607+0x1][_0x103207(0x160)]('td')[0x1][_0x103207(0x145)];if(_0x2f80c2[_0x103207(0x148)](_0x103207(0x152)))allPetState[_0x1eb305]={'state':0x3};else{if(_0x2f80c2['startsWith'](_0x103207(0x139))){allPetState[_0x1eb305]={'state':0x4,'timeLeft':parseTimeToMs(_0x2f80c2)};let _0x459254=parseTimeToMs(_0x2f80c2);const _0xaf65f1=document[_0x103207(0x12e)](_0x103207(0x159)+_0x1eb305);setTimeout(async function(){const _0x3b1807=_0x103207;console[_0x3b1807(0x176)](_0x3b1807(0x104));const _0x252e6b=await fetch(_0x51f25c[school],{'headers':{'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','accept-language':_0x3b1807(0x120),'cache-control':_0x3b1807(0x146)},'referrer':_0x51f25c[school],'body':null,'method':'GET','mode':_0x3b1807(0x109),'credentials':_0x3b1807(0x164)})['then'](_0x11fe60=>_0x11fe60[_0x3b1807(0x188)]());console[_0x3b1807(0x176)](_0x252e6b),updateData(_0x252e6b);},_0x459254);const _0x23b571=setInterval(function(){const _0x31cebc=_0x103207;_0xaf65f1[_0x31cebc(0x145)]=parseMsToTime(_0x459254),_0x459254-=0x3e8,_0x459254<=0x0&&clearInterval(_0x23b571);},0x3e8);clearInterval(petIntervals[_0x1eb305]),petIntervals[_0x1eb305]=_0x23b571;}else _0x2f80c2[_0x103207(0x148)](_0x103207(0x134))?allPetState[_0x1eb305]={'state':0x1,'cost':Array[_0x103207(0x111)](_0x3463a4[_0x2ce607+0x1]['querySelectorAll']('td')[0x1][_0x103207(0x160)]('b'))[_0x103207(0x13f)](_0x51c085=>_0x51c085[_0x103207(0x18a)])}:allPetState[_0x1eb305]={'state':0x0};}}}async function startTrainingPirate(){const _0x3ffe4d=a0_0x2d1ea6;let _0x2efd86=startedPets[_0x3ffe4d(0x168)](function(_0x5b646e){const _0x4a2ee3=_0x3ffe4d;return allPetState[_0x5b646e[_0x4a2ee3(0x15a)]][_0x4a2ee3(0x11e)]!==0x4&&_0x5b646e[_0x4a2ee3(0x122)]===school;})?.[_0x3ffe4d(0x15a)]||'';while(!_0x2efd86){_0x2efd86=startedPets[_0x3ffe4d(0x168)](function(_0x52139d){const _0x43ebd5=_0x3ffe4d;return allPetState[_0x52139d[_0x43ebd5(0x15a)]]['state']!==0x4&&_0x52139d['school']===school;})?.['petName']||'';if(_0x2efd86)break;await sleep(0x2710);}const _0x364c1b=petStats[_0x2efd86],_0x12d73f=allPetState[_0x2efd86],_0xd3dd05=settings[_0x2efd86],_0x5e6aca=document['querySelector'](_0x3ffe4d(0x159)+_0x2efd86);if(_0x12d73f['state']===0x3){_0x5e6aca[_0x3ffe4d(0x145)]=_0x3ffe4d(0x103);const _0x4a6042=await fetch(_0x3ffe4d(0x183),{'headers':{'accept':_0x3ffe4d(0x167),'accept-language':_0x3ffe4d(0x120),'cache-control':'no-cache','content-type':_0x3ffe4d(0x175)},'referrer':_0x3ffe4d(0x157),'body':_0x3ffe4d(0x150)+_0x2efd86,'method':_0x3ffe4d(0x17d),'mode':_0x3ffe4d(0x109),'credentials':_0x3ffe4d(0x164)})['then'](_0x101958=>_0x101958[_0x3ffe4d(0x188)]());await sleep(random_in_range(0x1f4,0x384));if(_0x4a6042['includes'](_0x3ffe4d(0x177))){const _0x3d3af3=await fetch(_0x3ffe4d(0x157),{'headers':{'accept':_0x3ffe4d(0x167),'accept-language':_0x3ffe4d(0x120),'cache-control':_0x3ffe4d(0x146)},'referrer':_0x3ffe4d(0x157),'body':null,'method':_0x3ffe4d(0x14d),'mode':_0x3ffe4d(0x109),'credentials':_0x3ffe4d(0x164)})['then'](_0x4985cf=>_0x4985cf[_0x3ffe4d(0x188)]());updateData(_0x3d3af3);}}else{if(_0x12d73f['state']===0x2){let _0x599b24=_0x12d73f[_0x3ffe4d(0x173)];_0x12d73f['state']=0x4,setTimeout(async function(){const _0x32a309=_0x3ffe4d,_0x1d7765=await fetch('https://www.neopets.com/pirates/academy.phtml?type=status',{'headers':{'accept':_0x32a309(0x167),'accept-language':'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,zh-TW;q=0.6,es;q=0.5','cache-control':_0x32a309(0x146)},'referrer':'https://www.neopets.com/pirates/academy.phtml?type=status','body':null,'method':_0x32a309(0x14d),'mode':_0x32a309(0x109),'credentials':_0x32a309(0x164)})[_0x32a309(0x131)](_0x21d9e9=>_0x21d9e9[_0x32a309(0x188)]());updateData(_0x1d7765);},_0x599b24);const _0x17d0b2=setInterval(function(){const _0x314b43=_0x3ffe4d;_0x5e6aca[_0x314b43(0x145)]=parseMsToTime(_0x599b24),_0x599b24-=0x3e8,_0x599b24<=0x0&&clearInterval(_0x17d0b2);},0x3e8);clearInterval(petIntervals[_0x2efd86]),petIntervals[_0x2efd86]=_0x17d0b2;}else{if(_0x12d73f[_0x3ffe4d(0x11e)]===0x1){_0x5e6aca[_0x3ffe4d(0x145)]='Buying\x20'+_0x12d73f[_0x3ffe4d(0x144)][0x0]+_0x3ffe4d(0x132),await buyItem(_0x12d73f[_0x3ffe4d(0x144)][0x0]),await sleep(random_in_range(0x1f4,0x384)),_0x5e6aca['innerHTML']=_0x3ffe4d(0x155);const _0x51b26c=await fetch(_0x3ffe4d(0x183),{'headers':{'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','accept-language':_0x3ffe4d(0x120),'cache-control':_0x3ffe4d(0x146),'content-type':_0x3ffe4d(0x175)},'referrer':_0x3ffe4d(0x157),'body':_0x3ffe4d(0x174)+_0x2efd86+_0x3ffe4d(0x105),'method':'POST','mode':_0x3ffe4d(0x109),'credentials':_0x3ffe4d(0x164)})[_0x3ffe4d(0x131)](_0x13d856=>_0x13d856['text']());await updateData(_0x51b26c);}else{let _0x3a10e3=0x98967f,_0x3189cb=_0x3ffe4d(0x147);_0xd3dd05['hp']&&_0x364c1b['hp']<_0x3a10e3&&(_0x3a10e3=_0x364c1b['hp'],_0x3189cb=_0x3ffe4d(0x14a));_0xd3dd05[_0x3ffe4d(0x130)]&&_0x364c1b['str']<_0x3a10e3&&(_0x3a10e3=_0x364c1b['str'],_0x3189cb='Strength');_0xd3dd05['def']&&_0x364c1b[_0x3ffe4d(0x16c)]<_0x3a10e3&&(_0x3a10e3=_0x364c1b[_0x3ffe4d(0x16c)],_0x3189cb=_0x3ffe4d(0x143));_0xd3dd05[_0x3ffe4d(0x136)]&&_0x364c1b[_0x3ffe4d(0x136)]<_0x3a10e3&&(_0x3a10e3=_0x364c1b[_0x3ffe4d(0x136)],_0x3189cb=_0x3ffe4d(0x10a));_0x3a10e3>_0x364c1b[_0x3ffe4d(0x13e)]*0x2&&(_0x3189cb=_0x3ffe4d(0x147));_0x5e6aca[_0x3ffe4d(0x145)]=_0x3ffe4d(0x180)+_0x3189cb+_0x3ffe4d(0x132);const _0x3773b3=await fetch(_0x3ffe4d(0x183),{'headers':{'accept':_0x3ffe4d(0x167),'accept-language':_0x3ffe4d(0x120),'cache-control':_0x3ffe4d(0x146),'content-type':_0x3ffe4d(0x175)},'referrer':_0x3ffe4d(0x17b),'body':'type=start&course_type='+_0x3189cb+'&pet_name='+_0x2efd86,'method':_0x3ffe4d(0x17d),'mode':'cors','credentials':'include'})[_0x3ffe4d(0x131)](_0x136807=>_0x136807[_0x3ffe4d(0x188)]());let _0x1bde5a=new DOMParser(),_0x4fc08a=_0x1bde5a[_0x3ffe4d(0x12d)](_0x3773b3,_0x3ffe4d(0x17c));_0x4fc08a[_0x3ffe4d(0x12e)](_0x3ffe4d(0x106))?(_0x5e6aca[_0x3ffe4d(0x145)]=_0x4fc08a[_0x3ffe4d(0x12e)]('.errorMessage')[_0x3ffe4d(0x18a)],startedPets=startedPets[_0x3ffe4d(0x121)](_0x3e4522=>_0x3e4522[_0x3ffe4d(0x15a)]!==_0x2efd86),GM_setValue(_0x3ffe4d(0x170),JSON[_0x3ffe4d(0x16d)](startedPets))):updateData(_0x3773b3);}}}await sleep(random_in_range(0x3e8,0x7d0)),startTrainingPirate();}async function startTrainingIsland(){const _0x1e85d2=a0_0x2d1ea6;let _0x3e641b;while(!_0x3e641b){_0x3e641b=startedPets[_0x1e85d2(0x168)](function(_0x858c2d){const _0x53e7a7=_0x1e85d2;return allPetState[_0x858c2d['petName']][_0x53e7a7(0x11e)]!==0x4&&_0x858c2d[_0x53e7a7(0x122)]===school;})?.[_0x1e85d2(0x15a)]||'';if(_0x3e641b)break;await sleep(0x2710);}const _0x4706c2=petStats[_0x3e641b],_0x23838e=allPetState[_0x3e641b],_0x569c85=settings[_0x3e641b],_0x2d74c6=document[_0x1e85d2(0x12e)](_0x1e85d2(0x159)+_0x3e641b);if(_0x23838e['state']===0x3){_0x2d74c6[_0x1e85d2(0x145)]=_0x1e85d2(0x103);const _0xabc48a=await fetch('https://www.neopets.com/island/process_training.phtml',{'headers':{'accept':_0x1e85d2(0x167),'accept-language':_0x1e85d2(0x120),'cache-control':'max-age=0','content-type':'application/x-www-form-urlencoded'},'referrer':_0x1e85d2(0x18d),'body':_0x1e85d2(0x150)+_0x3e641b,'method':_0x1e85d2(0x17d),'mode':_0x1e85d2(0x109),'credentials':_0x1e85d2(0x164)})[_0x1e85d2(0x131)](_0x23621f=>_0x23621f[_0x1e85d2(0x188)]());await sleep(random_in_range(0x1f4,0x384));if(_0xabc48a[_0x1e85d2(0x148)](_0x1e85d2(0x177))){const _0x4dfe1b=await fetch('https://www.neopets.com/island/training.phtml?type=status',{'headers':{'accept':_0x1e85d2(0x167),'accept-language':_0x1e85d2(0x120),'cache-control':_0x1e85d2(0x146)},'referrer':_0x1e85d2(0x18d),'body':null,'method':'GET','mode':_0x1e85d2(0x109),'credentials':_0x1e85d2(0x164)})[_0x1e85d2(0x131)](_0x5f4688=>_0x5f4688[_0x1e85d2(0x188)]());updateData(_0x4dfe1b);}}else{if(_0x23838e['state']===0x2){let _0xbfd4ab=_0x23838e[_0x1e85d2(0x173)];_0x23838e[_0x1e85d2(0x11e)]=0x4,setTimeout(async function(){const _0x195239=_0x1e85d2,_0x2d0a57=await fetch(_0x195239(0x18d),{'headers':{'accept':_0x195239(0x167),'accept-language':_0x195239(0x120),'cache-control':_0x195239(0x146)},'referrer':_0x195239(0x18d),'body':null,'method':_0x195239(0x14d),'mode':'cors','credentials':_0x195239(0x164)})[_0x195239(0x131)](_0x507912=>_0x507912[_0x195239(0x188)]());updateData(_0x2d0a57);},_0xbfd4ab);const _0x301601=setInterval(function(){_0x2d74c6['innerHTML']=parseMsToTime(_0xbfd4ab),_0xbfd4ab-=0x3e8,_0xbfd4ab<=0x0&&clearInterval(_0x301601);},0x3e8);clearInterval(petIntervals[_0x3e641b]),petIntervals[_0x3e641b]=_0x301601;}else{if(_0x23838e['state']===0x1){for(let _0x1a6fb4=0x0;_0x1a6fb4<_0x23838e['cost'][_0x1e85d2(0x11b)];_0x1a6fb4+=0x1){_0x2d74c6[_0x1e85d2(0x145)]=_0x1e85d2(0x149)+_0x23838e[_0x1e85d2(0x144)][_0x1a6fb4]+_0x1e85d2(0x132),await buyItem(_0x23838e[_0x1e85d2(0x144)][_0x1a6fb4]),await sleep(random_in_range(0x5dc,0x9c4));}_0x2d74c6[_0x1e85d2(0x145)]=_0x1e85d2(0x155);const _0x2194f1=await fetch(_0x1e85d2(0x18e),{'headers':{'accept':_0x1e85d2(0x167),'accept-language':_0x1e85d2(0x120),'cache-control':_0x1e85d2(0x154),'content-type':_0x1e85d2(0x175)},'referrer':_0x1e85d2(0x18d),'body':'pet_name='+_0x3e641b+'&type=pay','method':_0x1e85d2(0x17d),'mode':_0x1e85d2(0x109),'credentials':_0x1e85d2(0x164)})[_0x1e85d2(0x131)](_0x25ef98=>_0x25ef98[_0x1e85d2(0x188)]());await updateData(_0x2194f1);}else{let _0x33b5ca=0x98967f,_0x53c53e=_0x1e85d2(0x147);_0x569c85['hp']&&_0x4706c2['hp']<_0x33b5ca&&(_0x33b5ca=_0x4706c2['hp'],_0x53c53e='Endurance');_0x569c85[_0x1e85d2(0x130)]&&_0x4706c2['str']<_0x33b5ca&&(_0x33b5ca=_0x4706c2[_0x1e85d2(0x130)],_0x53c53e=_0x1e85d2(0x16e));_0x569c85[_0x1e85d2(0x16c)]&&_0x4706c2[_0x1e85d2(0x16c)]<_0x33b5ca&&(_0x33b5ca=_0x4706c2[_0x1e85d2(0x16c)],_0x53c53e=_0x1e85d2(0x143));_0x569c85[_0x1e85d2(0x136)]&&_0x4706c2[_0x1e85d2(0x136)]<_0x33b5ca&&(_0x33b5ca=_0x4706c2[_0x1e85d2(0x136)],_0x53c53e=_0x1e85d2(0x10a));(_0x4706c2['hp']>_0x4706c2[_0x1e85d2(0x13e)]*0x2||_0x4706c2[_0x1e85d2(0x130)]>_0x4706c2['lvl']*0x2||_0x4706c2[_0x1e85d2(0x16c)]>_0x4706c2[_0x1e85d2(0x13e)]*0x2||_0x4706c2[_0x1e85d2(0x136)]>_0x4706c2[_0x1e85d2(0x13e)]*0x2)&&(_0x53c53e='Level');_0x2d74c6[_0x1e85d2(0x145)]='Staring\x20course\x20in\x20'+_0x53c53e+_0x1e85d2(0x132);const _0x5c7787=await fetch(_0x1e85d2(0x18e),{'headers':{'accept':_0x1e85d2(0x167),'accept-language':_0x1e85d2(0x120),'cache-control':_0x1e85d2(0x154),'content-type':'application/x-www-form-urlencoded'},'referrer':'https://www.neopets.com/island/training.phtml?type=courses','body':_0x1e85d2(0x14f)+_0x53c53e+_0x1e85d2(0x14b)+_0x3e641b,'method':_0x1e85d2(0x17d),'mode':_0x1e85d2(0x109),'credentials':_0x1e85d2(0x164)})[_0x1e85d2(0x131)](_0x2cee12=>_0x2cee12[_0x1e85d2(0x188)]());let _0x4d5b36=new DOMParser(),_0x34bf8e=_0x4d5b36[_0x1e85d2(0x12d)](_0x5c7787,_0x1e85d2(0x17c));_0x34bf8e[_0x1e85d2(0x12e)](_0x1e85d2(0x106))?(_0x2d74c6['innerHTML']=_0x34bf8e[_0x1e85d2(0x12e)](_0x1e85d2(0x106))[_0x1e85d2(0x18a)],startedPets=startedPets[_0x1e85d2(0x121)](_0x15a1b8=>_0x15a1b8[_0x1e85d2(0x15a)]!==_0x3e641b),GM_setValue(_0x1e85d2(0x170),JSON[_0x1e85d2(0x16d)](startedPets))):updateData(_0x5c7787);}}}await sleep(random_in_range(0x3e8,0x7d0)),startTrainingIsland();}async function startTrainingNinja(){const _0x16b352=a0_0x2d1ea6,_0x52dbf9=startedPets['find'](function(_0x2c949c){const _0x45c07e=a0_0x31fc;return allPetState[_0x2c949c[_0x45c07e(0x15a)]][_0x45c07e(0x11e)]!==0x4&&_0x2c949c['school']===school;})?.[_0x16b352(0x15a)]||'';while(!_0x52dbf9){await sleep(0x2710);}const _0x306154=petStats[_0x52dbf9],_0x26e8b1=allPetState[_0x52dbf9],_0x2bfec1=settings[_0x52dbf9],_0x266b83=document[_0x16b352(0x12e)](_0x16b352(0x159)+_0x52dbf9);if(_0x26e8b1[_0x16b352(0x11e)]===0x3){return;_0x266b83[_0x16b352(0x145)]=_0x16b352(0x103);const _0x252ee5=await fetch(_0x16b352(0x13c),{'headers':{'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','accept-language':_0x16b352(0x120),'cache-control':_0x16b352(0x154),'content-type':_0x16b352(0x175)},'referrer':'https://www.neopets.com/island/fight_training.phtml?type=status','body':_0x16b352(0x150)+_0x52dbf9,'method':_0x16b352(0x17d),'mode':_0x16b352(0x109),'credentials':_0x16b352(0x164)})[_0x16b352(0x131)](_0x58d6e6=>_0x58d6e6['text']());await sleep(random_in_range(0x1f4,0x384));if(_0x252ee5[_0x16b352(0x148)]('Congratulations')){const _0x5140b9=await fetch(_0x16b352(0x14c),{'headers':{'accept':_0x16b352(0x167),'accept-language':_0x16b352(0x120),'priority':_0x16b352(0x179)},'referrer':_0x16b352(0x14c),'body':null,'method':_0x16b352(0x14d),'mode':_0x16b352(0x109),'credentials':_0x16b352(0x164)})['then'](_0x3f4981=>_0x3f4981[_0x16b352(0x188)]());updateData(_0x5140b9);}}else{if(_0x26e8b1['state']===0x2){let _0x24f3e4=_0x26e8b1['timeLeft'];_0x26e8b1[_0x16b352(0x11e)]=0x4,setTimeout(async function(){const _0x2d95f4=_0x16b352,_0x3cf895=await fetch('https://www.neopets.com/island/fight_training.phtml?type=status',{'headers':{'accept':_0x2d95f4(0x167),'accept-language':_0x2d95f4(0x120),'cache-control':_0x2d95f4(0x146)},'referrer':'https://www.neopets.com/island/fight_training.phtml?type=status','body':null,'method':'GET','mode':_0x2d95f4(0x109),'credentials':_0x2d95f4(0x164)})[_0x2d95f4(0x131)](_0x3bdcf6=>_0x3bdcf6[_0x2d95f4(0x188)]());updateData(_0x3cf895);},_0x24f3e4);const _0x14e092=setInterval(function(){const _0x387829=_0x16b352;_0x266b83[_0x387829(0x145)]=parseMsToTime(_0x24f3e4),_0x24f3e4-=0x3e8,_0x24f3e4<=0x0&&clearInterval(_0x14e092);},0x3e8);clearInterval(petIntervals[_0x52dbf9]),petIntervals[_0x52dbf9]=_0x14e092;}else{if(_0x26e8b1['state']===0x1){for(let _0x93422a=0x0;_0x93422a<_0x26e8b1[_0x16b352(0x144)]['length'];_0x93422a+=0x1){_0x266b83['innerHTML']='Buying\x20'+_0x26e8b1[_0x16b352(0x144)][_0x93422a]+_0x16b352(0x132),await buyItem(_0x26e8b1[_0x16b352(0x144)][_0x93422a]),await sleep(random_in_range(0x1f4,0x384));}_0x266b83[_0x16b352(0x145)]=_0x16b352(0x155);const _0x2aee42=await fetch('https://www.neopets.com/island/process_training.phtml',{'headers':{'accept':_0x16b352(0x167),'accept-language':_0x16b352(0x120),'cache-control':_0x16b352(0x154),'content-type':'application/x-www-form-urlencoded'},'referrer':_0x16b352(0x18d),'body':'pet_name='+_0x52dbf9+_0x16b352(0x105),'method':_0x16b352(0x17d),'mode':_0x16b352(0x109),'credentials':_0x16b352(0x164)})[_0x16b352(0x131)](_0x3a18c2=>_0x3a18c2['text']());await updateData(_0x2aee42);}else{let _0x551f1a=0x98967f,_0x1a069e='Level';_0x2bfec1['hp']&&_0x306154['hp']<_0x551f1a&&(_0x551f1a=_0x306154['hp'],_0x1a069e='Endurance');_0x2bfec1[_0x16b352(0x130)]&&_0x306154[_0x16b352(0x130)]<_0x551f1a&&(_0x551f1a=_0x306154[_0x16b352(0x130)],_0x1a069e=_0x16b352(0x16e));_0x2bfec1[_0x16b352(0x16c)]&&_0x306154[_0x16b352(0x16c)]<_0x551f1a&&(_0x551f1a=_0x306154[_0x16b352(0x16c)],_0x1a069e='Defence');_0x2bfec1[_0x16b352(0x136)]&&_0x306154[_0x16b352(0x136)]<_0x551f1a&&(_0x551f1a=_0x306154['mov'],_0x1a069e='Agility');(_0x306154['hp']>_0x306154['lvl']*0x2||_0x306154['str']>_0x306154[_0x16b352(0x13e)]*0x2||_0x306154[_0x16b352(0x16c)]>_0x306154['lvl']*0x2||_0x306154[_0x16b352(0x136)]>_0x306154['lvl']*0x2)&&(_0x1a069e=_0x16b352(0x147));_0x266b83[_0x16b352(0x145)]=_0x16b352(0x180)+_0x1a069e+_0x16b352(0x132);const _0x352c60=await fetch(_0x16b352(0x13c),{'headers':{'accept':_0x16b352(0x167),'accept-language':_0x16b352(0x120),'cache-control':_0x16b352(0x154),'content-type':_0x16b352(0x175)},'referrer':_0x16b352(0x11a),'body':_0x16b352(0x14f)+_0x1a069e+'&pet_name='+_0x52dbf9,'method':'POST','mode':_0x16b352(0x109),'credentials':'include'})[_0x16b352(0x131)](_0x2c967e=>_0x2c967e['text']());let _0x3d5601=new DOMParser(),_0x2a3c5d=_0x3d5601['parseFromString'](_0x352c60,_0x16b352(0x17c));_0x2a3c5d[_0x16b352(0x12e)]('.errorMessage')?(_0x266b83[_0x16b352(0x145)]=_0x2a3c5d[_0x16b352(0x12e)]('.errorMessage')['textContent'],startedPets=startedPets[_0x16b352(0x121)](_0x3048c3=>_0x3048c3[_0x16b352(0x15a)]!==_0x52dbf9),GM_setValue(_0x16b352(0x170),JSON[_0x16b352(0x16d)](startedPets))):updateData(_0x352c60);}}}await sleep(random_in_range(0x3e8,0x7d0)),startTrainingIsland();}function getStatPanel(_0x11c6a2){const _0x184b1e=a0_0x2d1ea6,_0x3aca4c=petStats[_0x11c6a2],_0x28d320=startedPets[_0x184b1e(0x168)](_0x4b557e=>_0x4b557e['petName']===_0x11c6a2),_0x21b6fb=settings[_0x11c6a2],_0x2818c1=document[_0x184b1e(0x158)](_0x184b1e(0x12a));if(!_0x28d320||_0x28d320[_0x184b1e(0x122)]===school){_0x2818c1[_0x184b1e(0x145)]='\x0a<div>--\x20Auto\x20Train\x20Stats\x20--</div>\x0a\x20\x20<div\x20style=\x22margin-top:\x208px\x22>\x0a\x20\x20<label><input\x20name=\x22hp\x22\x20type=\x22checkbox\x22\x20'+(_0x28d320?_0x184b1e(0x166):'')+_0x184b1e(0x17a)+(_0x28d320?'disabled':'')+_0x184b1e(0x15d)+(_0x28d320?_0x184b1e(0x166):'')+'\x20/>\x20Def</label>\x0a\x20\x20<label><input\x20name=\x22mov\x22\x20type=\x22checkbox\x22\x20'+(_0x28d320?_0x184b1e(0x166):'')+_0x184b1e(0x141)+(_0x28d320?_0x184b1e(0x116):_0x184b1e(0x10e))+'</button>\x0a</div>';const _0x3d82cf=_0x2818c1[_0x184b1e(0x12e)](_0x184b1e(0x112)),_0x53bf29=_0x2818c1['querySelector']('[name=\x22str\x22]'),_0x595803=_0x2818c1['querySelector']('[name=\x22def\x22]'),_0x32f126=_0x2818c1[_0x184b1e(0x12e)]('[name=\x22mov\x22]');[_0x3d82cf,_0x53bf29,_0x595803,_0x32f126][_0x184b1e(0x113)](function(_0xecea31){const _0x5aa5e5=_0x184b1e;_0xecea31['checked']=_0x21b6fb[_0xecea31['getAttribute'](_0x5aa5e5(0x184))],_0xecea31[_0x5aa5e5(0x17f)](_0x5aa5e5(0x178),function(_0x42b9c1){const _0x98cf5b=_0x5aa5e5;_0x21b6fb[_0x42b9c1[_0x98cf5b(0x181)][_0x98cf5b(0x15e)](_0x98cf5b(0x184))]=_0x42b9c1[_0x98cf5b(0x181)][_0x98cf5b(0x162)],GM_setValue('settings',JSON[_0x98cf5b(0x16d)](settings));});});const _0x165524=_0x2818c1[_0x184b1e(0x12e)](_0x184b1e(0x18b));_0x165524[_0x184b1e(0x17f)]('click',function(){const _0x155a86=_0x184b1e;if(!startedPets[_0x155a86(0x168)](_0x55b7ba=>_0x55b7ba[_0x155a86(0x15a)]===_0x11c6a2&&_0x55b7ba[_0x155a86(0x122)]===school)){_0x165524[_0x155a86(0x166)]=!![],_0x165524[_0x155a86(0x145)]=_0x155a86(0x116),_0x3d82cf['disabled']=!![],_0x53bf29[_0x155a86(0x166)]=!![],_0x595803[_0x155a86(0x166)]=!![],_0x32f126[_0x155a86(0x166)]=!![],startedPets[_0x155a86(0x16a)]({'petName':_0x11c6a2,'school':school});if(school===_0x155a86(0x16b))startTrainingPirate();else school==='island'&&startTrainingIsland();}else _0x165524[_0x155a86(0x166)]=![],_0x165524[_0x155a86(0x145)]=_0x155a86(0x10e),_0x3d82cf[_0x155a86(0x166)]=![],_0x53bf29['disabled']=![],_0x595803[_0x155a86(0x166)]=![],_0x32f126[_0x155a86(0x166)]=![],startedPets=startedPets[_0x155a86(0x121)](_0x218289=>_0x218289[_0x155a86(0x15a)]!==_0x11c6a2);GM_setValue('started_pets',JSON[_0x155a86(0x16d)](startedPets));});}else _0x2818c1[_0x184b1e(0x145)]='Training\x20at\x20'+schoolName[_0x28d320['school']];return _0x2818c1;}function a0_0x1648(){const _0x2120aa=['navigate','from','[name=\x22hp\x22]','forEach','Cap\x27n\x20Threelegs\x27\x20Swashbuckling\x20Academy','703826MRXSkk','Stop','21JPHfSw','en-US','https://www.neopets.com/np-templates/ajax/wizard.php','https://www.neopets.com/island/fight_training.phtml?type=courses','length','\x20hrs,\x20','.wizard-char.wizard-char-single.wizard-char-old\x20+\x20p\x20+\x20p','state','\x20minutes,\x20','en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,zh-TW;q=0.6,es;q=0.5','filter','school','price','Mystery\x20Island\x20Training\x20School','2535056NeXcUU','1573268ZAwIsp','outerHTML','7080xUvUqL','match','div','replace','same-origin','parseFromString','querySelector','panel_','str','then','...','214689wHsrsm','value=\x22Pay\x22','href','mov','Secret\x20Ninja\x20Training\x20School','/pirates/academy.phtml','Time\x20till\x20course\x20finishes','error','startsWith','https://www.neopets.com/island/process_fight_training.phtml','I\x20am\x20too\x20busy\x20right\x20now,\x20please\x20come\x20back\x20in\x20about\x20','lvl','map','830634jHTdeA','\x20/>\x20Mov</label>\x0a\x20\x20<br\x20/>\x0a\x20\x20<button\x20style=\x22margin-top:\x208px\x22>','https://www.neopets.com/shops/wizard.phtml','Defence','cost','innerHTML','no-cache','Level','includes','Buying\x20','Endurance','&pet_name=','https://www.neopets.com/island/fight_training.phtml?type=status','GET','trim','type=start&course_type=','type=complete&pet_name=','island','value=\x22Complete\x20Course!\x22','parse','max-age=0','Paying\x20for\x20course...','.wizard-results-grid\x20li:not(.wizard-results-grid-header)','https://www.neopets.com/pirates/academy.phtml?type=status','createElement','#panel_','petName','Item\x20not\x20found!','500217UPxyXz','\x20/>\x20Str</label>\x0a\x20\x20<label><input\x20name=\x22def\x22\x20type=\x22checkbox\x22\x20','getAttribute','Sorry\x20-\x20The\x20owner\x20of\x20this\x20shop\x20has\x20been\x20frozen!','querySelectorAll','text/html,\x20*/*;\x20q=0.01','checked','\x20NP','include','The\x20item\x20you\x20are\x20trying\x20to\x20buy\x20does\x20not\x20exist\x20in\x20this\x20shop!','disabled','text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','find','\x20minutes\x20and\x20I\x20can\x20help\x20you\x20out.','push','pirate','def','stringify','Strength','strict-origin-when-cross-origin','started_pets','append','documentElement','timeLeft','pet_name=','application/x-www-form-urlencoded','log','Congratulations','change','u=0,\x20i','\x20/>\x20Hp</label>\x0a\x20\x20<label><input\x20name=\x22str\x22\x20type=\x22checkbox\x22\x20','https://www.neopets.com/pirates/academy.phtml?type=courses','text/html','POST','\x22Windows\x22','addEventListener','Staring\x20course\x20in\x20','target','\x20seconds','https://www.neopets.com/pirates/process_academy.phtml','name','split','&table=shop&criteria=exact&min_price=0&max_price=999999','settings','text','type=process_wizard&feedset=0&shopwizard=','textContent','button','[width=\x22500\x22][align=\x22center\x22]\x20>\x20tbody\x20>\x20tr','https://www.neopets.com/island/training.phtml?type=status','https://www.neopets.com/island/process_training.phtml','Finishing\x20course...','Training\x20finished','&type=pay','.errorMessage','pathname','application/x-www-form-urlencoded;\x20charset=UTF-8','cors','Agility','link','floor','.wizard-results-price','Start','catch'];a0_0x1648=function(){return _0x2120aa;};return a0_0x1648();}(async function(){'use strict';const _0x24fd2f=a0_0x2d1ea6;try{const _0xbc9012=document[_0x24fd2f(0x172)][_0x24fd2f(0x127)];if(location[_0x24fd2f(0x107)][_0x24fd2f(0x13b)](_0x24fd2f(0x138))){school=_0x24fd2f(0x16b);const _0x5a204b=document[_0x24fd2f(0x160)](_0x24fd2f(0x18c));for(let _0x2f6b97=0x0;_0x2f6b97<_0x5a204b[_0x24fd2f(0x11b)];_0x2f6b97+=0x2){const _0x243996=_0x5a204b[_0x2f6b97][_0x24fd2f(0x18a)][_0x24fd2f(0x185)]('\x20')[0x0];!settings[_0x243996]&&(settings[_0x243996]={'hp':![],'str':![],'def':![],'mov':![]},GM_setValue(_0x24fd2f(0x187),JSON[_0x24fd2f(0x16d)](settings)));const _0x40a2dc=getStatPanel(_0x243996);_0x5a204b[_0x2f6b97+0x1][_0x24fd2f(0x160)]('td')[0x1]['innerHTML']='',_0x5a204b[_0x2f6b97+0x1]['querySelectorAll']('td')[0x1][_0x24fd2f(0x171)](_0x40a2dc);const _0x32e656=document[_0x24fd2f(0x158)](_0x24fd2f(0x12a));_0x32e656['id']=_0x24fd2f(0x12f)+_0x243996,_0x5a204b[_0x2f6b97+0x1][_0x24fd2f(0x160)]('td')[0x1][_0x24fd2f(0x171)](_0x32e656);}updateData(_0xbc9012),startTrainingPirate();}else{if(location[_0x24fd2f(0x107)][_0x24fd2f(0x13b)]('/island/training.phtml')){school=_0x24fd2f(0x151);const _0x4e4b9c=document[_0x24fd2f(0x160)]('[width=\x22500\x22][align=\x22center\x22]\x20>\x20tbody\x20>\x20tr');for(let _0x2e7704=0x0;_0x2e7704<_0x4e4b9c[_0x24fd2f(0x11b)];_0x2e7704+=0x2){const _0x8badf5=_0x4e4b9c[_0x2e7704][_0x24fd2f(0x18a)]['split']('\x20')[0x0];!settings[_0x8badf5]&&(settings[_0x8badf5]={'hp':![],'str':![],'def':![],'mov':![]},GM_setValue(_0x24fd2f(0x187),JSON[_0x24fd2f(0x16d)](settings)));const _0x3d6347=getStatPanel(_0x8badf5);_0x4e4b9c[_0x2e7704+0x1]['querySelectorAll']('td')[0x1][_0x24fd2f(0x145)]='',_0x4e4b9c[_0x2e7704+0x1][_0x24fd2f(0x160)]('td')[0x1][_0x24fd2f(0x171)](_0x3d6347);const _0x269565=document[_0x24fd2f(0x158)](_0x24fd2f(0x12a));_0x269565['id']='panel_'+_0x8badf5,_0x4e4b9c[_0x2e7704+0x1]['querySelectorAll']('td')[0x1]['append'](_0x269565);}updateData(_0xbc9012),startTrainingIsland();}else{if(location[_0x24fd2f(0x107)][_0x24fd2f(0x13b)]('/island/fight_training.phtml')){school='ninja';const _0x12dda1=document[_0x24fd2f(0x160)]('[width=\x22500\x22][align=\x22center\x22]\x20>\x20tbody\x20>\x20tr');for(let _0x36df05=0x0;_0x36df05<_0x12dda1[_0x24fd2f(0x11b)];_0x36df05+=0x2){const _0x221a3d=_0x12dda1[_0x36df05][_0x24fd2f(0x18a)][_0x24fd2f(0x185)]('\x20')[0x0];!settings[_0x221a3d]&&(settings[_0x221a3d]={'hp':![],'str':![],'def':![],'mov':![]},GM_setValue('settings',JSON[_0x24fd2f(0x16d)](settings)));const _0x82626f=getStatPanel(_0x221a3d);_0x12dda1[_0x36df05+0x1]['querySelectorAll']('td')[0x1][_0x24fd2f(0x145)]='',_0x12dda1[_0x36df05+0x1][_0x24fd2f(0x160)]('td')[0x1][_0x24fd2f(0x171)](_0x82626f);const _0x50fc69=document[_0x24fd2f(0x158)]('div');_0x50fc69['id']=_0x24fd2f(0x12f)+_0x221a3d,_0x12dda1[_0x36df05+0x1][_0x24fd2f(0x160)]('td')[0x1][_0x24fd2f(0x171)](_0x50fc69);}updateData(_0xbc9012);}}}}catch(_0x579697){console[_0x24fd2f(0x176)](_0x579697);}}());
