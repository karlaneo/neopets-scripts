// ==UserScript==
// @name         Neopets - Karla's Auto Trainer
// @namespace    karla@neopointskarla
// @license      GPL3
// @version      0.0.2
// @description  Automatically marks comic as read without hovering
// @author       Karla
// @match        *://*.neopets.com/pirates/academy.phtml?type=status*
// @match        *://*.neopets.com/island/training.phtml?type=status*
// @match        *://*.neopets.com/island/fight_training.phtml?type=status*
// @icon         https://github.com/karlaneo/neopets-scripts/blob/main/favicon-32x32.png?raw=true
// @grant        GM_getValue
// @grant        GM_setValue
// @downloadURL  https://github.com/karlaneo/neopets-scripts/raw/refs/heads/main/auto_trainer.user.js
// @updateURL    https://github.com/karlaneo/neopets-scripts/raw/refs/heads/main/auto_trainer.user.js
// ==/UserScript==

const a0_0x2cf04a=a0_0x1de1;(function(_0x35ab1b,_0x4365a5){const _0x4ea16d=a0_0x1de1,_0x1e6322=_0x35ab1b();while(!![]){try{const _0xcfbacd=parseInt(_0x4ea16d(0xa7))/0x1*(parseInt(_0x4ea16d(0xa8))/0x2)+parseInt(_0x4ea16d(0xb8))/0x3+parseInt(_0x4ea16d(0x70))/0x4+parseInt(_0x4ea16d(0xb4))/0x5*(parseInt(_0x4ea16d(0xde))/0x6)+-parseInt(_0x4ea16d(0x89))/0x7+parseInt(_0x4ea16d(0x91))/0x8+parseInt(_0x4ea16d(0x92))/0x9*(-parseInt(_0x4ea16d(0xbc))/0xa);if(_0xcfbacd===_0x4365a5)break;else _0x1e6322['push'](_0x1e6322['shift']());}catch(_0x1b8bd8){_0x1e6322['push'](_0x1e6322['shift']());}}}(a0_0x2a24,0x22694));const settings=JSON['parse'](GM_getValue(a0_0x2cf04a(0x97))||'{}');let startedPets=JSON[a0_0x2cf04a(0xb3)](GM_getValue('started_pets')||'[]');const allPetState={},petStats={};let school;const petIntervals={},schoolName={'pirate':'Cap\x27n\x20Threelegs\x27\x20Swashbuckling\x20Academy','island':a0_0x2cf04a(0x6e),'ninja':'Secret\x20Ninja\x20Training\x20School'},sleep=_0x1afed7=>new Promise(_0x44d333=>setTimeout(_0x44d333,_0x1afed7)),random_in_range=(_0x388a56,_0x44f6e8)=>{const _0x2d0ef4=a0_0x2cf04a;return Math[_0x2d0ef4(0x8b)](Math[_0x2d0ef4(0x83)]()*(_0x44f6e8-_0x388a56+0x1)+_0x388a56);};function parseTimeToMs(_0x93ba0){const _0x260969=a0_0x2cf04a,_0x2a2487=_0x93ba0[_0x260969(0xf6)](/(\d+)\s*hrs.*?(\d+)\s*minutes.*?(\d+)\s*seconds/i);if(!_0x2a2487)return null;const _0x182bca=Number(_0x2a2487[0x1]),_0xaa0e60=Number(_0x2a2487[0x2]),_0x185d16=Number(_0x2a2487[0x3]);return(_0x182bca*0x3c*0x3c+_0xaa0e60*0x3c+_0x185d16)*0x3e8;}function parseMsToTime(_0x1fd823){const _0x4dad30=a0_0x2cf04a,_0x5b3d1c=Math[_0x4dad30(0x8b)](_0x1fd823/0x3e8),_0x288e5a=Math['floor'](_0x5b3d1c/0xe10),_0x33f27f=Math[_0x4dad30(0x8b)](_0x5b3d1c%0xe10/0x3c),_0xb72d81=_0x5b3d1c%0x3c;return _0x288e5a+_0x4dad30(0x88)+_0x33f27f+_0x4dad30(0xab)+_0xb72d81+'\x20seconds';}function a0_0x1de1(_0x2897b5,_0x2a1386){const _0x2a2401=a0_0x2a24();return a0_0x1de1=function(_0x1de11f,_0x1ba33f){_0x1de11f=_0x1de11f-0x6e;let _0x533890=_0x2a2401[_0x1de11f];return _0x533890;},a0_0x1de1(_0x2897b5,_0x2a1386);}async function buyItem(_0x5c1008){const _0x23a624=a0_0x2cf04a;let _0xb2e09=[];for(let _0x46fe6e=0x0;_0x46fe6e<0x5;_0x46fe6e+=0x1){const _0x46a376=await fetch(_0x23a624(0xe3),{'headers':{'accept':_0x23a624(0x7a),'accept-language':_0x23a624(0x72),'content-type':_0x23a624(0xfa),'x-requested-with':_0x23a624(0xcd)},'referrer':_0x23a624(0xad),'referer':_0x23a624(0xad),'referrerPolicy':_0x23a624(0x86),'body':_0x23a624(0xc5)+encodeURIComponent(_0x5c1008)+'&table=shop&criteria=exact&min_price=0&max_price=999999','method':_0x23a624(0x94),'mode':_0x23a624(0xec),'credentials':_0x23a624(0xa6)})[_0x23a624(0xc8)](_0x49897a=>_0x49897a['text']());let _0x2a406f=new DOMParser(),_0x8cde7c=_0x2a406f[_0x23a624(0x7c)](_0x46a376,_0x23a624(0xcf));if(_0x46a376[_0x23a624(0x9e)](_0x23a624(0x76))){const _0x2be6f4=_0x8cde7c[_0x23a624(0xbd)](_0x23a624(0x9f))[_0x23a624(0xee)],_0x4e3d05=Number(_0x2be6f4[_0x23a624(0xf9)](_0x23a624(0x80),'')['replace']('\x20minutes\x20and\x20I\x20can\x20help\x20you\x20out.',''));if(_0xb2e09[_0x23a624(0xf1)]>0x0)break;else{await sleep((_0x4e3d05+0x2)*0x3c*0x3e8),_0x46fe6e-=0x1;continue;}}const _0x147f6c=_0x8cde7c['querySelectorAll']('.wizard-results-grid\x20li:not(.wizard-results-grid-header)');for(let _0x2033ab=0x0;_0x2033ab<_0x147f6c[_0x23a624(0xf1)];_0x2033ab+=0x1){const _0x3e0706=_0x147f6c[_0x2033ab],_0x420e56=Number(_0x3e0706[_0x23a624(0xbd)](_0x23a624(0x7b))['textContent'][_0x23a624(0xe8)]()[_0x23a624(0xf9)](/,/g,'')[_0x23a624(0xf9)](_0x23a624(0x84),'')),_0x196faf=_0x3e0706['querySelector']('a')[_0x23a624(0xc1)];!_0xb2e09['find'](_0x29535d=>_0x29535d[_0x23a624(0xe7)]===_0x196faf)&&_0xb2e09['push']({'price':_0x420e56,'link':_0x196faf});}_0x46fe6e===0x4&&!_0xb2e09[_0x23a624(0xf1)]===0x0&&(_0x46fe6e-=0x1),await sleep(random_in_range(0x2bc,0x4b0));}_0xb2e09['sort']((_0x17ce41,_0x241ae6)=>_0x17ce41[_0x23a624(0xd5)]-_0x241ae6[_0x23a624(0xd5)]);for(let _0x4b11ba=0x0;_0x4b11ba<_0xb2e09[_0x23a624(0xf1)];_0x4b11ba+=0x1){const {link:_0x1392cf}=_0xb2e09[_0x4b11ba],_0x7eb7a1=await fetch(_0x1392cf,{'headers':{'accept':_0x23a624(0xd4),'Accept-Language':_0x23a624(0x72)},'referrer':_0x23a624(0xad),'referer':_0x23a624(0xad),'referrerPolicy':_0x23a624(0x86),'body':null,'method':'GET','mode':_0x23a624(0xec),'credentials':'include'})[_0x23a624(0xc8)](_0xbff2df=>_0xbff2df[_0x23a624(0xac)]())[_0x23a624(0xa1)](_0x1ad145=>({'error':_0x23a624(0xc6),'err':_0x1ad145}));if(_0x7eb7a1[_0x23a624(0x9e)](_0x23a624(0xbe)))continue;else{if(_0x7eb7a1[_0x23a624(0x9e)]('Sorry\x20-\x20The\x20owner\x20of\x20this\x20shop\x20has\x20been\x20frozen!')){await sleep(0x4b0,0x5dc);continue;}}let _0xaf3241=new DOMParser(),_0x5c838a=_0xaf3241['parseFromString'](_0x7eb7a1,_0x23a624(0xcf));const _0x2af605=_0x5c838a[_0x23a624(0xbd)](_0x23a624(0xf0))[_0x23a624(0x7d)](_0x23a624(0xc1)),_0x5ae39e=await fetch('https://www.neopets.com/'+_0x2af605,{'headers':{'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','accept-language':_0x23a624(0x72),'sec-ch-ua-mobile':'?0','sec-ch-ua-platform':_0x23a624(0x8f),'sec-fetch-dest':_0x23a624(0xca),'sec-fetch-mode':_0x23a624(0xf5),'sec-fetch-site':_0x23a624(0x90),'sec-fetch-user':'?1','upgrade-insecure-requests':'1'},'referrer':_0x1392cf,'referer':_0x1392cf,'referrerPolicy':_0x23a624(0x86),'body':null,'method':_0x23a624(0xbf),'mode':'cors','credentials':_0x23a624(0xa6)})[_0x23a624(0xc8)](_0x3836b1=>_0x3836b1['text']())[_0x23a624(0xa1)](_0x240a6b=>({'error':_0x23a624(0xc6),'err':_0x240a6b}));if(_0x5ae39e[_0x23a624(0x9e)](_0x23a624(0xaf))){await sleep(0x4b0,0x5dc);continue;}break;}}function updateData(_0x540bd5){const _0x20772f=a0_0x2cf04a;let _0x31d0c4=new DOMParser(),_0x1e5a0a=_0x31d0c4[_0x20772f(0x7c)](_0x540bd5,'text/html');const _0x4f8ef9={'pirate':_0x20772f(0x8d),'island':_0x20772f(0x73),'ninja':_0x20772f(0xc3)},_0x30224d=_0x1e5a0a[_0x20772f(0xcb)](_0x20772f(0xf3));for(let _0x43ca03=0x0;_0x43ca03<_0x30224d[_0x20772f(0xf1)];_0x43ca03+=0x2){const _0x35eca5=_0x30224d[_0x43ca03]['textContent']['split']('\x20')[0x0],_0xca5804=_0x30224d[_0x43ca03+0x1]['innerHTML'],_0x38057f={'lvl':Number(_0xca5804[_0x20772f(0xf6)](/Lvl\s*:\s*.*?<b>(\d+)<\/b>/i)[0x1]),'str':Number(_0xca5804['match'](/Str\s*:\s*<b>(\d+)<\/b>/i)[0x1]),'def':Number(_0xca5804[_0x20772f(0xf6)](/Def\s*:\s*<b>(\d+)<\/b>/i)[0x1]),'mov':Number(_0xca5804['match'](/Mov\s*:\s*<b>(\d+)<\/b>/i)[0x1]),'hp':Number(_0xca5804[_0x20772f(0xf6)](/Hp\s*:\s*<b>(\d+)\s*\/\s*(\d+)<\/b>/i)[0x2])};petStats[_0x35eca5]=_0x38057f;const _0x3bb1e4=_0x30224d[_0x43ca03+0x1][_0x20772f(0xcb)]('td')[0x1][_0x20772f(0xc7)];if(_0x3bb1e4[_0x20772f(0x9e)](_0x20772f(0xd7)))allPetState[_0x35eca5]={'state':0x3};else{if(_0x3bb1e4[_0x20772f(0xdd)](_0x20772f(0xce)))allPetState[_0x35eca5]={'state':0x2,'timeLeft':parseTimeToMs(_0x3bb1e4)};else _0x3bb1e4[_0x20772f(0x9e)](_0x20772f(0xeb))?allPetState[_0x35eca5]={'state':0x1,'cost':Array['from'](_0x30224d[_0x43ca03+0x1][_0x20772f(0xcb)]('td')[0x1][_0x20772f(0xcb)]('b'))[_0x20772f(0xa0)](_0x279257=>_0x279257[_0x20772f(0xee)])}:allPetState[_0x35eca5]={'state':0x0};}}}async function startTrainingPirate(){const _0x4a6b10=a0_0x2cf04a;let _0xdfdc38=startedPets[_0x4a6b10(0x77)](function(_0x20a555){const _0x2ccd36=_0x4a6b10;return allPetState[_0x20a555[_0x2ccd36(0x87)]]['state']!==0x4&&_0x20a555[_0x2ccd36(0xb6)]===school;})?.[_0x4a6b10(0x87)]||'';while(!_0xdfdc38){_0xdfdc38=startedPets[_0x4a6b10(0x77)](function(_0xbfbba6){const _0x8bb2b4=_0x4a6b10;return allPetState[_0xbfbba6[_0x8bb2b4(0x87)]][_0x8bb2b4(0x8c)]!==0x4&&_0xbfbba6[_0x8bb2b4(0xb6)]===school;})?.[_0x4a6b10(0x87)]||'';if(_0xdfdc38)break;await sleep(0x2710);}const _0x13c3b9=petStats[_0xdfdc38],_0x523213=allPetState[_0xdfdc38],_0x4364fd=settings[_0xdfdc38],_0x422ea7=document['querySelector'](_0x4a6b10(0xa2)+_0xdfdc38);if(_0x523213[_0x4a6b10(0x8c)]===0x3){_0x422ea7[_0x4a6b10(0xc7)]=_0x4a6b10(0x99);const _0x4e95e2=await fetch(_0x4a6b10(0x98),{'headers':{'accept':_0x4a6b10(0xd4),'accept-language':_0x4a6b10(0xe6),'cache-control':_0x4a6b10(0xdb),'content-type':'application/x-www-form-urlencoded'},'referrer':_0x4a6b10(0x8d),'body':_0x4a6b10(0x7e)+_0xdfdc38,'method':'POST','mode':_0x4a6b10(0xec),'credentials':_0x4a6b10(0xa6)})[_0x4a6b10(0xc8)](_0x555c93=>_0x555c93[_0x4a6b10(0xac)]());await sleep(random_in_range(0x1f4,0x384));if(_0x4e95e2[_0x4a6b10(0x9e)](_0x4a6b10(0xe2))){const _0x23cf0f=await fetch(_0x4a6b10(0x8d),{'headers':{'accept':_0x4a6b10(0xd4),'accept-language':_0x4a6b10(0xe6),'cache-control':_0x4a6b10(0xdb)},'referrer':_0x4a6b10(0x8d),'body':null,'method':'GET','mode':_0x4a6b10(0xec),'credentials':_0x4a6b10(0xa6)})[_0x4a6b10(0xc8)](_0x4ef54a=>_0x4ef54a['text']());updateData(_0x23cf0f);}}else{if(_0x523213['state']===0x2){let _0x3d78b7=_0x523213[_0x4a6b10(0xd3)];_0x523213[_0x4a6b10(0x8c)]=0x4;const _0x2e7d12=setInterval(async function(){const _0x5811e8=_0x4a6b10;_0x422ea7[_0x5811e8(0xc7)]=parseMsToTime(_0x3d78b7),_0x3d78b7-=0x3e8;if(_0x3d78b7<=0x0){const _0x102c01=await fetch(_0x5811e8(0x8d),{'headers':{'accept':_0x5811e8(0xd4),'accept-language':_0x5811e8(0xe6),'cache-control':_0x5811e8(0xdb)},'referrer':_0x5811e8(0x8d),'body':null,'method':_0x5811e8(0xbf),'mode':_0x5811e8(0xec),'credentials':_0x5811e8(0xa6)})['then'](_0x8aaca0=>_0x8aaca0[_0x5811e8(0xac)]());updateData(_0x102c01),clearInterval(_0x2e7d12);}},0x3e8);clearInterval(petIntervals[_0xdfdc38]),petIntervals[_0xdfdc38]=_0x2e7d12;}else{if(_0x523213[_0x4a6b10(0x8c)]===0x1){_0x422ea7[_0x4a6b10(0xc7)]=_0x4a6b10(0xea)+_0x523213[_0x4a6b10(0xdf)][0x0]+_0x4a6b10(0xd6),await buyItem(_0x523213[_0x4a6b10(0xdf)][0x0]),await sleep(random_in_range(0x1f4,0x384)),_0x422ea7[_0x4a6b10(0xc7)]=_0x4a6b10(0xb1);const _0x12e815=await fetch(_0x4a6b10(0x98),{'headers':{'accept':_0x4a6b10(0xd4),'accept-language':_0x4a6b10(0xe6),'cache-control':'no-cache','content-type':_0x4a6b10(0xe9)},'referrer':_0x4a6b10(0x8d),'body':_0x4a6b10(0x81)+_0xdfdc38+_0x4a6b10(0xc0),'method':'POST','mode':_0x4a6b10(0xec),'credentials':_0x4a6b10(0xa6)})['then'](_0x3384e2=>_0x3384e2[_0x4a6b10(0xac)]());await updateData(_0x12e815);}else{let _0x43c255=0x98967f,_0x756b43='Level';_0x4364fd['hp']&&_0x13c3b9['hp']<_0x43c255&&(_0x43c255=_0x13c3b9['hp'],_0x756b43='Endurance');_0x4364fd[_0x4a6b10(0xc4)]&&_0x13c3b9[_0x4a6b10(0xc4)]<_0x43c255&&(_0x43c255=_0x13c3b9[_0x4a6b10(0xc4)],_0x756b43=_0x4a6b10(0x93));_0x4364fd[_0x4a6b10(0xe0)]&&_0x13c3b9[_0x4a6b10(0xe0)]<_0x43c255&&(_0x43c255=_0x13c3b9[_0x4a6b10(0xe0)],_0x756b43=_0x4a6b10(0x78));_0x4364fd[_0x4a6b10(0xa4)]&&_0x13c3b9[_0x4a6b10(0xa4)]<_0x43c255&&(_0x43c255=_0x13c3b9[_0x4a6b10(0xa4)],_0x756b43=_0x4a6b10(0xef));(_0x13c3b9['hp']>_0x13c3b9[_0x4a6b10(0x82)]*0x2||_0x13c3b9[_0x4a6b10(0xc4)]>_0x13c3b9[_0x4a6b10(0x82)]*0x2||_0x13c3b9[_0x4a6b10(0xe0)]>_0x13c3b9[_0x4a6b10(0x82)]*0x2||_0x13c3b9[_0x4a6b10(0xa4)]>_0x13c3b9[_0x4a6b10(0x82)]*0x2)&&(_0x756b43=_0x4a6b10(0x6f));_0x422ea7[_0x4a6b10(0xc7)]=_0x4a6b10(0xf2)+_0x756b43+'...';const _0x3a669c=await fetch(_0x4a6b10(0x98),{'headers':{'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','accept-language':_0x4a6b10(0xe6),'cache-control':'no-cache','content-type':_0x4a6b10(0xe9)},'referrer':_0x4a6b10(0xb0),'body':_0x4a6b10(0x74)+_0x756b43+_0x4a6b10(0x8e)+_0xdfdc38,'method':_0x4a6b10(0x94),'mode':_0x4a6b10(0xec),'credentials':_0x4a6b10(0xa6)})[_0x4a6b10(0xc8)](_0x1d327f=>_0x1d327f[_0x4a6b10(0xac)]());let _0x5c4b4e=new DOMParser(),_0x19b226=_0x5c4b4e['parseFromString'](_0x3a669c,_0x4a6b10(0xcf));_0x19b226[_0x4a6b10(0xbd)](_0x4a6b10(0x71))?(_0x422ea7[_0x4a6b10(0xc7)]=_0x19b226[_0x4a6b10(0xbd)](_0x4a6b10(0x71))['textContent'],startedPets=startedPets['filter'](_0x151072=>_0x151072[_0x4a6b10(0x87)]!==_0xdfdc38),GM_setValue(_0x4a6b10(0xe5),JSON[_0x4a6b10(0x95)](startedPets))):updateData(_0x3a669c);}}}await sleep(random_in_range(0x3e8,0x7d0)),startTrainingPirate();}async function startTrainingIsland(){const _0x5cf53e=a0_0x2cf04a;let _0x1dc11a;while(!_0x1dc11a){_0x1dc11a=startedPets[_0x5cf53e(0x77)](function(_0x1a70c1){const _0x122d9b=_0x5cf53e;return allPetState[_0x1a70c1[_0x122d9b(0x87)]]['state']!==0x4&&_0x1a70c1[_0x122d9b(0xb6)]===school;})?.[_0x5cf53e(0x87)]||'';if(_0x1dc11a)break;await sleep(0x2710);}const _0x262409=petStats[_0x1dc11a],_0x81cde3=allPetState[_0x1dc11a],_0x55389b=settings[_0x1dc11a],_0x49ad64=document[_0x5cf53e(0xbd)](_0x5cf53e(0xa2)+_0x1dc11a);if(_0x81cde3['state']===0x3){_0x49ad64[_0x5cf53e(0xc7)]=_0x5cf53e(0x99);const _0x3a8f0c=await fetch(_0x5cf53e(0xe1),{'headers':{'accept':_0x5cf53e(0xd4),'accept-language':'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,zh-TW;q=0.6,es;q=0.5','cache-control':'max-age=0','content-type':'application/x-www-form-urlencoded'},'referrer':'https://www.neopets.com/island/training.phtml?type=status','body':'type=complete&pet_name='+_0x1dc11a,'method':_0x5cf53e(0x94),'mode':_0x5cf53e(0xec),'credentials':'include'})[_0x5cf53e(0xc8)](_0x21848c=>_0x21848c[_0x5cf53e(0xac)]());await sleep(random_in_range(0x1f4,0x384));if(_0x3a8f0c['includes'](_0x5cf53e(0xe2))){const _0x15407b=await fetch(_0x5cf53e(0x73),{'headers':{'accept':_0x5cf53e(0xd4),'accept-language':_0x5cf53e(0xe6),'cache-control':'no-cache'},'referrer':'https://www.neopets.com/island/training.phtml?type=status','body':null,'method':_0x5cf53e(0xbf),'mode':'cors','credentials':'include'})[_0x5cf53e(0xc8)](_0x24d323=>_0x24d323[_0x5cf53e(0xac)]());updateData(_0x15407b);}}else{if(_0x81cde3[_0x5cf53e(0x8c)]===0x2){let _0x17699c=_0x81cde3[_0x5cf53e(0xd3)];_0x81cde3[_0x5cf53e(0x8c)]=0x4,setTimeout(async function(){const _0x483db4=_0x5cf53e,_0x496cf3=await fetch(_0x483db4(0x73),{'headers':{'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','accept-language':'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,zh-TW;q=0.6,es;q=0.5','cache-control':_0x483db4(0xdb)},'referrer':'https://www.neopets.com/island/training.phtml?type=status','body':null,'method':_0x483db4(0xbf),'mode':_0x483db4(0xec),'credentials':_0x483db4(0xa6)})['then'](_0xc278b5=>_0xc278b5[_0x483db4(0xac)]());updateData(_0x496cf3);},_0x17699c);const _0x33143b=setInterval(function(){_0x49ad64['innerHTML']=parseMsToTime(_0x17699c),_0x17699c-=0x3e8,_0x17699c<=0x0&&clearInterval(_0x33143b);},0x3e8);clearInterval(petIntervals[_0x1dc11a]),petIntervals[_0x1dc11a]=_0x33143b;}else{if(_0x81cde3[_0x5cf53e(0x8c)]===0x1){for(let _0x3247a8=0x0;_0x3247a8<_0x81cde3[_0x5cf53e(0xdf)][_0x5cf53e(0xf1)];_0x3247a8+=0x1){_0x49ad64[_0x5cf53e(0xc7)]='Buying\x20'+_0x81cde3[_0x5cf53e(0xdf)][_0x3247a8]+_0x5cf53e(0xd6),await buyItem(_0x81cde3['cost'][_0x3247a8]),await sleep(random_in_range(0x5dc,0x9c4));}_0x49ad64[_0x5cf53e(0xc7)]=_0x5cf53e(0xb1);const _0x540e37=await fetch('https://www.neopets.com/island/process_training.phtml',{'headers':{'accept':_0x5cf53e(0xd4),'accept-language':'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,zh-TW;q=0.6,es;q=0.5','cache-control':_0x5cf53e(0xb9),'content-type':_0x5cf53e(0xe9)},'referrer':'https://www.neopets.com/island/training.phtml?type=status','body':'pet_name='+_0x1dc11a+_0x5cf53e(0xc0),'method':_0x5cf53e(0x94),'mode':_0x5cf53e(0xec),'credentials':_0x5cf53e(0xa6)})[_0x5cf53e(0xc8)](_0x11593c=>_0x11593c[_0x5cf53e(0xac)]());await updateData(_0x540e37);}else{let _0x4bc4e9=0x98967f,_0x42347f=_0x5cf53e(0x6f);_0x55389b['hp']&&_0x262409['hp']<_0x4bc4e9&&(_0x4bc4e9=_0x262409['hp'],_0x42347f=_0x5cf53e(0xb7));_0x55389b[_0x5cf53e(0xc4)]&&_0x262409[_0x5cf53e(0xc4)]<_0x4bc4e9&&(_0x4bc4e9=_0x262409[_0x5cf53e(0xc4)],_0x42347f='Strength');_0x55389b['def']&&_0x262409['def']<_0x4bc4e9&&(_0x4bc4e9=_0x262409['def'],_0x42347f='Defence');_0x55389b[_0x5cf53e(0xa4)]&&_0x262409[_0x5cf53e(0xa4)]<_0x4bc4e9&&(_0x4bc4e9=_0x262409['mov'],_0x42347f=_0x5cf53e(0xef));(_0x262409['hp']>_0x262409[_0x5cf53e(0x82)]*0x2||_0x262409[_0x5cf53e(0xc4)]>_0x262409[_0x5cf53e(0x82)]*0x2||_0x262409[_0x5cf53e(0xe0)]>_0x262409['lvl']*0x2||_0x262409[_0x5cf53e(0xa4)]>_0x262409['lvl']*0x2)&&(_0x42347f=_0x5cf53e(0x6f));_0x49ad64[_0x5cf53e(0xc7)]=_0x5cf53e(0xf2)+_0x42347f+'...';const _0x101ae1=await fetch(_0x5cf53e(0xe1),{'headers':{'accept':_0x5cf53e(0xd4),'accept-language':_0x5cf53e(0xe6),'cache-control':'max-age=0','content-type':'application/x-www-form-urlencoded'},'referrer':_0x5cf53e(0xaa),'body':_0x5cf53e(0x74)+_0x42347f+_0x5cf53e(0x8e)+_0x1dc11a,'method':_0x5cf53e(0x94),'mode':_0x5cf53e(0xec),'credentials':_0x5cf53e(0xa6)})['then'](_0x137127=>_0x137127[_0x5cf53e(0xac)]());let _0x3c392f=new DOMParser(),_0x4b8571=_0x3c392f[_0x5cf53e(0x7c)](_0x101ae1,_0x5cf53e(0xcf));_0x4b8571[_0x5cf53e(0xbd)](_0x5cf53e(0x71))?(_0x49ad64[_0x5cf53e(0xc7)]=_0x4b8571[_0x5cf53e(0xbd)](_0x5cf53e(0x71))[_0x5cf53e(0xee)],startedPets=startedPets[_0x5cf53e(0x9d)](_0x2c7e9b=>_0x2c7e9b[_0x5cf53e(0x87)]!==_0x1dc11a),GM_setValue(_0x5cf53e(0xe5),JSON[_0x5cf53e(0x95)](startedPets))):updateData(_0x101ae1);}}}await sleep(random_in_range(0x3e8,0x7d0)),startTrainingIsland();}async function startTrainingNinja(){const _0x39c996=a0_0x2cf04a,_0x2ce6c6=startedPets['find'](function(_0x274eda){const _0x2d5c27=a0_0x1de1;return allPetState[_0x274eda[_0x2d5c27(0x87)]][_0x2d5c27(0x8c)]!==0x4&&_0x274eda[_0x2d5c27(0xb6)]===school;})?.[_0x39c996(0x87)]||'';while(!_0x2ce6c6){await sleep(0x2710);}const _0x2ddc4e=petStats[_0x2ce6c6],_0x5a3571=allPetState[_0x2ce6c6],_0x795b57=settings[_0x2ce6c6],_0x140e6e=document[_0x39c996(0xbd)](_0x39c996(0xa2)+_0x2ce6c6);if(_0x5a3571[_0x39c996(0x8c)]===0x3){return;_0x140e6e[_0x39c996(0xc7)]=_0x39c996(0x99);const _0x40896e=await fetch(_0x39c996(0x9c),{'headers':{'accept':_0x39c996(0xd4),'accept-language':_0x39c996(0xe6),'cache-control':_0x39c996(0xb9),'content-type':_0x39c996(0xe9)},'referrer':'https://www.neopets.com/island/fight_training.phtml?type=status','body':'type=complete&pet_name='+_0x2ce6c6,'method':_0x39c996(0x94),'mode':_0x39c996(0xec),'credentials':_0x39c996(0xa6)})[_0x39c996(0xc8)](_0x2a687b=>_0x2a687b[_0x39c996(0xac)]());await sleep(random_in_range(0x1f4,0x384));if(_0x40896e['includes'](_0x39c996(0xe2))){const _0x5dacfa=await fetch(_0x39c996(0xc3),{'headers':{'accept':_0x39c996(0xd4),'accept-language':_0x39c996(0xe6),'priority':_0x39c996(0xa9)},'referrer':_0x39c996(0xc3),'body':null,'method':_0x39c996(0xbf),'mode':_0x39c996(0xec),'credentials':_0x39c996(0xa6)})[_0x39c996(0xc8)](_0x286c35=>_0x286c35['text']());updateData(_0x5dacfa);}}else{if(_0x5a3571['state']===0x2){let _0xe99e7b=_0x5a3571[_0x39c996(0xd3)];_0x5a3571[_0x39c996(0x8c)]=0x4;const _0x4ba0ea=setInterval(async function(){const _0x4bc793=_0x39c996;_0x140e6e[_0x4bc793(0xc7)]=parseMsToTime(_0xe99e7b),_0xe99e7b-=0x3e8;if(_0xe99e7b<=0x0){const _0x2aaa30=await fetch(_0x4bc793(0xc3),{'headers':{'accept':_0x4bc793(0xd4),'accept-language':'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,zh-TW;q=0.6,es;q=0.5','cache-control':_0x4bc793(0xdb)},'referrer':_0x4bc793(0xc3),'body':null,'method':'GET','mode':_0x4bc793(0xec),'credentials':'include'})[_0x4bc793(0xc8)](_0x480288=>_0x480288[_0x4bc793(0xac)]());updateData(_0x2aaa30),clearInterval(_0x4ba0ea);}},0x3e8);clearInterval(petIntervals[_0x2ce6c6]),petIntervals[_0x2ce6c6]=_0x4ba0ea;}else{if(_0x5a3571['state']===0x1){for(let _0x529692=0x0;_0x529692<_0x5a3571['cost'][_0x39c996(0xf1)];_0x529692+=0x1){_0x140e6e[_0x39c996(0xc7)]=_0x39c996(0xea)+_0x5a3571['cost'][_0x529692]+'...',await buyItem(_0x5a3571['cost'][_0x529692]),await sleep(random_in_range(0x1f4,0x384));}_0x140e6e['innerHTML']='Paying\x20for\x20course...';const _0x1d0d77=await fetch(_0x39c996(0xe1),{'headers':{'accept':_0x39c996(0xd4),'accept-language':'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,zh-TW;q=0.6,es;q=0.5','cache-control':_0x39c996(0xb9),'content-type':_0x39c996(0xe9)},'referrer':_0x39c996(0x73),'body':_0x39c996(0x81)+_0x2ce6c6+_0x39c996(0xc0),'method':'POST','mode':_0x39c996(0xec),'credentials':_0x39c996(0xa6)})['then'](_0x2b4089=>_0x2b4089['text']());await updateData(_0x1d0d77);}else{let _0x34025c=0x98967f,_0x1fa57f=_0x39c996(0x6f);_0x795b57['hp']&&_0x2ddc4e['hp']<_0x34025c&&(_0x34025c=_0x2ddc4e['hp'],_0x1fa57f=_0x39c996(0xb7));_0x795b57[_0x39c996(0xc4)]&&_0x2ddc4e['str']<_0x34025c&&(_0x34025c=_0x2ddc4e[_0x39c996(0xc4)],_0x1fa57f=_0x39c996(0x93));_0x795b57[_0x39c996(0xe0)]&&_0x2ddc4e['def']<_0x34025c&&(_0x34025c=_0x2ddc4e[_0x39c996(0xe0)],_0x1fa57f=_0x39c996(0x78));_0x795b57[_0x39c996(0xa4)]&&_0x2ddc4e[_0x39c996(0xa4)]<_0x34025c&&(_0x34025c=_0x2ddc4e[_0x39c996(0xa4)],_0x1fa57f=_0x39c996(0xef));(_0x2ddc4e['hp']>_0x2ddc4e[_0x39c996(0x82)]*0x2||_0x2ddc4e[_0x39c996(0xc4)]>_0x2ddc4e[_0x39c996(0x82)]*0x2||_0x2ddc4e['def']>_0x2ddc4e[_0x39c996(0x82)]*0x2||_0x2ddc4e[_0x39c996(0xa4)]>_0x2ddc4e[_0x39c996(0x82)]*0x2)&&(_0x1fa57f=_0x39c996(0x6f));_0x140e6e['innerHTML']=_0x39c996(0xf2)+_0x1fa57f+'...';const _0x53df11=await fetch(_0x39c996(0x9c),{'headers':{'accept':_0x39c996(0xd4),'accept-language':_0x39c996(0xe6),'cache-control':_0x39c996(0xb9),'content-type':_0x39c996(0xe9)},'referrer':_0x39c996(0x96),'body':_0x39c996(0x74)+_0x1fa57f+_0x39c996(0x8e)+_0x2ce6c6,'method':'POST','mode':_0x39c996(0xec),'credentials':_0x39c996(0xa6)})[_0x39c996(0xc8)](_0x2af601=>_0x2af601[_0x39c996(0xac)]());let _0x38df66=new DOMParser(),_0x32567a=_0x38df66['parseFromString'](_0x53df11,_0x39c996(0xcf));_0x32567a[_0x39c996(0xbd)](_0x39c996(0x71))?(_0x140e6e[_0x39c996(0xc7)]=_0x32567a[_0x39c996(0xbd)](_0x39c996(0x71))['textContent'],startedPets=startedPets['filter'](_0x567a3e=>_0x567a3e['petName']!==_0x2ce6c6),GM_setValue(_0x39c996(0xe5),JSON['stringify'](startedPets))):updateData(_0x53df11);}}}await sleep(random_in_range(0x3e8,0x7d0)),startTrainingNinja();}function getStatPanel(_0x4c8ebc){const _0x1e4a94=a0_0x2cf04a,_0x4b330a=petStats[_0x4c8ebc],_0x35064c=startedPets[_0x1e4a94(0x77)](_0x5c3752=>_0x5c3752['petName']===_0x4c8ebc),_0x2b11f2=settings[_0x4c8ebc],_0x1bb410=document['createElement'](_0x1e4a94(0xf8));if(!_0x35064c||_0x35064c[_0x1e4a94(0xb6)]===school){_0x1bb410[_0x1e4a94(0xc7)]=_0x1e4a94(0xd8)+(_0x35064c?'disabled':'')+'\x20/>\x20Hp</label>\x0a\x20\x20<label><input\x20name=\x22str\x22\x20type=\x22checkbox\x22\x20'+(_0x35064c?_0x1e4a94(0xd0):'')+_0x1e4a94(0x8a)+(_0x35064c?_0x1e4a94(0xd0):'')+_0x1e4a94(0x79)+(_0x35064c?_0x1e4a94(0xd0):'')+_0x1e4a94(0xf7)+(_0x35064c?_0x1e4a94(0xb5):_0x1e4a94(0xba))+'</button>\x0a</div>';const _0x161636=_0x1bb410['querySelector']('[name=\x22hp\x22]'),_0x25034a=_0x1bb410[_0x1e4a94(0xbd)](_0x1e4a94(0xb2)),_0x186bfe=_0x1bb410[_0x1e4a94(0xbd)](_0x1e4a94(0xbb)),_0x3680de=_0x1bb410['querySelector'](_0x1e4a94(0xed));[_0x161636,_0x25034a,_0x186bfe,_0x3680de]['forEach'](function(_0x1ef187){const _0x4c381a=_0x1e4a94;_0x1ef187['checked']=_0x2b11f2[_0x1ef187[_0x4c381a(0x7d)]('name')],_0x1ef187[_0x4c381a(0xcc)](_0x4c381a(0x85),function(_0x32fead){const _0x293197=_0x4c381a;_0x2b11f2[_0x32fead[_0x293197(0xae)][_0x293197(0x7d)](_0x293197(0xd2))]=_0x32fead['target'][_0x293197(0xe4)],GM_setValue(_0x293197(0x97),JSON[_0x293197(0x95)](settings));});});const _0x231afa=_0x1bb410[_0x1e4a94(0xbd)](_0x1e4a94(0x9b));_0x231afa[_0x1e4a94(0xcc)]('click',function(){const _0x4ea6d1=_0x1e4a94;!startedPets[_0x4ea6d1(0x77)](_0x5b7d4a=>_0x5b7d4a[_0x4ea6d1(0x87)]===_0x4c8ebc&&_0x5b7d4a[_0x4ea6d1(0xb6)]===school)?(_0x231afa[_0x4ea6d1(0xd0)]=!![],_0x231afa['innerHTML']=_0x4ea6d1(0xb5),_0x161636[_0x4ea6d1(0xd0)]=!![],_0x25034a[_0x4ea6d1(0xd0)]=!![],_0x186bfe[_0x4ea6d1(0xd0)]=!![],_0x3680de['disabled']=!![],startedPets[_0x4ea6d1(0xa3)]({'petName':_0x4c8ebc,'school':school})):(_0x231afa[_0x4ea6d1(0xd0)]=![],_0x231afa['innerHTML']=_0x4ea6d1(0xba),_0x161636['disabled']=![],_0x25034a[_0x4ea6d1(0xd0)]=![],_0x186bfe[_0x4ea6d1(0xd0)]=![],_0x3680de[_0x4ea6d1(0xd0)]=![],startedPets=startedPets[_0x4ea6d1(0x9d)](_0x2fa6c7=>_0x2fa6c7[_0x4ea6d1(0x87)]!==_0x4c8ebc)),GM_setValue('started_pets',JSON['stringify'](startedPets));});}else _0x1bb410[_0x1e4a94(0xc7)]='Training\x20at\x20'+schoolName[_0x35064c[_0x1e4a94(0xb6)]];return _0x1bb410;}(async function(){'use strict';const _0x346619=a0_0x2cf04a;try{const _0x3354ea=document[_0x346619(0xf4)][_0x346619(0x7f)];if(location[_0x346619(0xdc)][_0x346619(0xdd)]('/pirates/academy.phtml')){school=_0x346619(0xda);const _0x23cda3=document['querySelectorAll'](_0x346619(0xf3));for(let _0x2be88d=0x0;_0x2be88d<_0x23cda3[_0x346619(0xf1)];_0x2be88d+=0x2){const _0x251bc9=_0x23cda3[_0x2be88d][_0x346619(0xee)]['split']('\x20')[0x0];!settings[_0x251bc9]&&(settings[_0x251bc9]={'hp':![],'str':![],'def':![],'mov':![]},GM_setValue(_0x346619(0x97),JSON[_0x346619(0x95)](settings)));const _0x465e1a=getStatPanel(_0x251bc9);_0x23cda3[_0x2be88d+0x1][_0x346619(0xcb)]('td')[0x1][_0x346619(0xc7)]='',_0x23cda3[_0x2be88d+0x1][_0x346619(0xcb)]('td')[0x1][_0x346619(0xc2)](_0x465e1a);const _0x30008e=document[_0x346619(0xd9)](_0x346619(0xf8));_0x30008e['id']=_0x346619(0xc9)+_0x251bc9,_0x23cda3[_0x2be88d+0x1]['querySelectorAll']('td')[0x1][_0x346619(0xc2)](_0x30008e);}updateData(_0x3354ea),startTrainingPirate();}else{if(location[_0x346619(0xdc)][_0x346619(0xdd)](_0x346619(0xd1))){school=_0x346619(0x9a);const _0x2a1b26=document[_0x346619(0xcb)](_0x346619(0xf3));for(let _0x434ceb=0x0;_0x434ceb<_0x2a1b26[_0x346619(0xf1)];_0x434ceb+=0x2){const _0x174b21=_0x2a1b26[_0x434ceb]['textContent']['split']('\x20')[0x0];!settings[_0x174b21]&&(settings[_0x174b21]={'hp':![],'str':![],'def':![],'mov':![]},GM_setValue('settings',JSON[_0x346619(0x95)](settings)));const _0x3e6e91=getStatPanel(_0x174b21);_0x2a1b26[_0x434ceb+0x1][_0x346619(0xcb)]('td')[0x1][_0x346619(0xc7)]='',_0x2a1b26[_0x434ceb+0x1][_0x346619(0xcb)]('td')[0x1][_0x346619(0xc2)](_0x3e6e91);const _0x146e12=document[_0x346619(0xd9)](_0x346619(0xf8));_0x146e12['id']=_0x346619(0xc9)+_0x174b21,_0x2a1b26[_0x434ceb+0x1][_0x346619(0xcb)]('td')[0x1][_0x346619(0xc2)](_0x146e12);}updateData(_0x3354ea),startTrainingIsland();}else{if(location['pathname'][_0x346619(0xdd)](_0x346619(0xa5))){school='ninja';const _0x2dfcaa=document[_0x346619(0xcb)](_0x346619(0xf3));for(let _0x311122=0x0;_0x311122<_0x2dfcaa[_0x346619(0xf1)];_0x311122+=0x2){const _0x1d39a7=_0x2dfcaa[_0x311122][_0x346619(0xee)]['split']('\x20')[0x0];!settings[_0x1d39a7]&&(settings[_0x1d39a7]={'hp':![],'str':![],'def':![],'mov':![]},GM_setValue(_0x346619(0x97),JSON[_0x346619(0x95)](settings)));const _0x591f82=getStatPanel(_0x1d39a7);_0x2dfcaa[_0x311122+0x1][_0x346619(0xcb)]('td')[0x1][_0x346619(0xc7)]='',_0x2dfcaa[_0x311122+0x1][_0x346619(0xcb)]('td')[0x1]['append'](_0x591f82);const _0x12e7f0=document[_0x346619(0xd9)](_0x346619(0xf8));_0x12e7f0['id']='panel_'+_0x1d39a7,_0x2dfcaa[_0x311122+0x1][_0x346619(0xcb)]('td')[0x1][_0x346619(0xc2)](_0x12e7f0);}updateData(_0x3354ea);}}}}catch(_0x5a7a0f){console[_0x346619(0x75)](_0x5a7a0f);}}());function a0_0x2a24(){const _0x1f9978=['Time\x20till\x20course\x20finishes','text/html','disabled','/island/training.phtml','name','timeLeft','text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7','price','...','value=\x22Complete\x20Course!\x22','\x0a<div>--\x20Auto\x20Train\x20Stats\x20--</div>\x0a\x20\x20<div\x20style=\x22margin-top:\x208px\x22>\x0a\x20\x20<label><input\x20name=\x22hp\x22\x20type=\x22checkbox\x22\x20','createElement','pirate','no-cache','pathname','startsWith','846bFApfE','cost','def','https://www.neopets.com/island/process_training.phtml','Congratulations','https://www.neopets.com/np-templates/ajax/wizard.php','checked','started_pets','en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,zh-TW;q=0.6,es;q=0.5','link','trim','application/x-www-form-urlencoded','Buying\x20','value=\x22Pay\x22','cors','[name=\x22mov\x22]','textContent','Agility','a[href^=\x22buy_item.phtml\x22]','length','Staring\x20course\x20in\x20','[width=\x22500\x22][align=\x22center\x22]\x20>\x20tbody\x20>\x20tr','documentElement','navigate','match','\x20/>\x20Mov</label>\x0a\x20\x20<br\x20/>\x0a\x20\x20<button\x20style=\x22margin-top:\x208px\x22>','div','replace','application/x-www-form-urlencoded;\x20charset=UTF-8','Mystery\x20Island\x20Training\x20School','Level','879992PjSbLM','.errorMessage','en-US','https://www.neopets.com/island/training.phtml?type=status','type=start&course_type=','log','Whoa\x20there,\x20too\x20many\x20searches!','find','Defence','\x20/>\x20Def</label>\x0a\x20\x20<label><input\x20name=\x22mov\x22\x20type=\x22checkbox\x22\x20','text/html,\x20*/*;\x20q=0.01','.wizard-results-price','parseFromString','getAttribute','type=complete&pet_name=','outerHTML','I\x20am\x20too\x20busy\x20right\x20now,\x20please\x20come\x20back\x20in\x20about\x20','pet_name=','lvl','random','\x20NP','change','strict-origin-when-cross-origin','petName','\x20hrs,\x20','146776RuFXih','\x20/>\x20Str</label>\x0a\x20\x20<label><input\x20name=\x22def\x22\x20type=\x22checkbox\x22\x20','floor','state','https://www.neopets.com/pirates/academy.phtml?type=status','&pet_name=','\x22Windows\x22','same-origin','853712bhXPRx','90kpEFFD','Strength','POST','stringify','https://www.neopets.com/island/fight_training.phtml?type=courses','settings','https://www.neopets.com/pirates/process_academy.phtml','Finishing\x20course...','island','button','https://www.neopets.com/island/process_fight_training.phtml','filter','includes','.wizard-char.wizard-char-single.wizard-char-old\x20+\x20p\x20+\x20p','map','catch','#panel_','push','mov','/island/fight_training.phtml','include','33PybVSu','4958SfAQob','u=0,\x20i','https://www.neopets.com/island/training.phtml?type=courses','\x20minutes,\x20','text','https://www.neopets.com/shops/wizard.phtml','target','The\x20item\x20you\x20are\x20trying\x20to\x20buy\x20does\x20not\x20exist\x20in\x20this\x20shop!','https://www.neopets.com/pirates/academy.phtml?type=courses','Paying\x20for\x20course...','[name=\x22str\x22]','parse','8435jlieDX','Stop','school','Endurance','277890vtOGEb','max-age=0','Start','[name=\x22def\x22]','577100QPyxyz','querySelector','Item\x20not\x20found!','GET','&type=pay','href','append','https://www.neopets.com/island/fight_training.phtml?type=status','str','type=process_wizard&feedset=0&shopwizard=','error','innerHTML','then','panel_','document','querySelectorAll','addEventListener','XMLHttpRequest'];a0_0x2a24=function(){return _0x1f9978;};return a0_0x2a24();}
