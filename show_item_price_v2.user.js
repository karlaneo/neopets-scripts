// ==UserScript==
// @name         Neopets - Karla's item price display V2
// @namespace    karla@neopointskarla
// @license      GPL3
// @version      0.0.2
// @description  Display item price from itemdb
// @author       Karla
// @match        *://*.neopets.com/safetydeposit*
// @match        *://*.neopets.com/auctions*
// @homepage     https://neopointskarla.com
// @icon         https://github.com/karlaneo/neopets-scripts/blob/main/favicon-32x32.png?raw=true
// @grant        GM.xmlHttpRequest
// @downloadURL  https://github.com/karlaneo/neopets-scripts/raw/refs/heads/main/show_item_price_v2.user.js
// @updateURL    https://github.com/karlaneo/neopets-scripts/raw/refs/heads/main/show_item_price_v2.user.js
// ==/UserScript==

(function(_0x49491c,_0x195ea7){const _0x84a981=a0_0x285d,_0x1729a1=_0x49491c();while(!![]){try{const _0x975f51=parseInt(_0x84a981(0x1a0))/0x1*(-parseInt(_0x84a981(0x1b7))/0x2)+-parseInt(_0x84a981(0x1c0))/0x3*(parseInt(_0x84a981(0x1c9))/0x4)+-parseInt(_0x84a981(0x19e))/0x5*(parseInt(_0x84a981(0x1b5))/0x6)+-parseInt(_0x84a981(0x1c3))/0x7*(-parseInt(_0x84a981(0x1b8))/0x8)+-parseInt(_0x84a981(0x1d5))/0x9*(-parseInt(_0x84a981(0x1b2))/0xa)+-parseInt(_0x84a981(0x1ce))/0xb*(parseInt(_0x84a981(0x1c2))/0xc)+parseInt(_0x84a981(0x18f))/0xd;if(_0x975f51===_0x195ea7)break;else _0x1729a1['push'](_0x1729a1['shift']());}catch(_0x591794){_0x1729a1['push'](_0x1729a1['shift']());}}}(a0_0x38ed,0xbeb4e));function formatNumber(_0x16b61e){const _0x4cd383=a0_0x285d;if(_0x16b61e>=0x3b9aca00)return(_0x16b61e/0x3b9aca00)[_0x4cd383(0x190)](0x1)[_0x4cd383(0x1a7)](/\.0$/,'')+'b';else{if(_0x16b61e>=0xf4240)return(_0x16b61e/0xf4240)[_0x4cd383(0x190)](0x1)[_0x4cd383(0x1a7)](/\.0$/,'')+'m';else return _0x16b61e>=0x3e8?(_0x16b61e/0x3e8)[_0x4cd383(0x190)](0x1)[_0x4cd383(0x1a7)](/\.0$/,'')+'k':_0x16b61e['toString']();}}const fetchItemData=async _0x334f0=>{const _0x168a17=a0_0x285d,_0x21d95a=await new Promise((_0x17de2f,_0xeacdcb)=>{const _0x39db99=a0_0x285d;GM[_0x39db99(0x1a6)]({'method':_0x39db99(0x1dd),'url':_0x39db99(0x198),'headers':{'Content-Type':_0x39db99(0x1b6)},'data':JSON[_0x39db99(0x195)]({'name_image_id':_0x334f0[_0x39db99(0x1bc)](_0x1ffc29=>[_0x1ffc29[_0x39db99(0x1dc)],_0x1ffc29['itemImgId']])}),'onload':function(_0x520d07){const _0x4d3931=_0x39db99;_0x17de2f(JSON[_0x4d3931(0x1ab)](_0x520d07[_0x4d3931(0x1b9)]));},'onerror':function(_0x2911af){const _0x3f87af=_0x39db99;_0xeacdcb(_0x3f87af(0x192),_0x2911af);}});}),_0x269656=_0x334f0[_0x168a17(0x1bc)](_0x226671=>({..._0x226671,'price':_0x21d95a[encodeURIComponent(_0x226671['itemName'])[_0x168a17(0x1a1)]()+'_'+_0x226671[_0x168a17(0x193)]]?.['price']?.[_0x168a17(0x1d3)]||0x0,'ncPrice':_0x21d95a[encodeURIComponent(_0x226671[_0x168a17(0x1dc)])[_0x168a17(0x1a1)]()+'_'+_0x226671['itemImgId']]?.[_0x168a17(0x1a2)]?.[_0x168a17(0x199)]}));return _0x269656;},fetchItemData2=async _0xb3e88f=>{const _0x5c4717=a0_0x285d,_0x5a1863=await new Promise((_0x1476a5,_0x20ff73)=>{const _0x5a2cff=a0_0x285d;GM[_0x5a2cff(0x1a6)]({'method':_0x5a2cff(0x1dd),'url':'https://itemdb.com.br/api/v1/items/many','headers':{'Content-Type':'application/json'},'data':JSON['stringify']({'name':_0xb3e88f[_0x5a2cff(0x1bc)](_0x40f484=>_0x40f484[_0x5a2cff(0x1dc)])}),'onload':function(_0x2a758e){const _0x4e5368=_0x5a2cff;_0x1476a5(JSON[_0x4e5368(0x1ab)](_0x2a758e[_0x4e5368(0x1b9)]));},'onerror':function(_0x4964cf){_0x20ff73('Request\x20failed:',_0x4964cf);}});}),_0x1c3740=_0xb3e88f[_0x5c4717(0x1bc)](_0x210fed=>({..._0x210fed,'price':_0x5a1863[_0x210fed[_0x5c4717(0x1dc)]]?.[_0x5c4717(0x1c7)]?.['value']||0x0,'ncPrice':_0x5a1863[_0x210fed[_0x5c4717(0x1dc)]]?.['ncValue']?.[_0x5c4717(0x199)]}));return _0x1c3740;};function a0_0x38ed(){const _0x4bc74a=['9YKdzSK','align','\x20NP','<b>Unit\x20Price</b>','\x20caps</b>','filter','href','itemName','POST','250','prepend','innerHTML','43893785BJwyOL','toFixed','</b>','Request\x20failed:','itemImgId','\x0a\x0a\x20\x20\x0a\x0a','stringify','textContent','/safetydeposit','https://itemdb.com.br/api/v1/items/many','range','src','width','includes','contentModuleHeaderAlt','6434620fMHbhU','#ffbe0b','7iavJib','toLowerCase','ncValue','[name=\x22quickstock\x22]\x20table','center','setAttribute','xmlHttpRequest','replace','location','from','colspan','parse','insertBefore','100','textAlign','querySelectorAll','style','log','5226340TpbQbL','forEach','right','6TUWBgD','application/json','77876cpOydK','64DOIlkI','responseText','<b>','split','map','[colspan=\x226\x22]','Check\x20All','img','3dlwSxU','createElement','564nurAnR','210266yIjYKq','bgcolor','#ff595e','Unit\x20Price','price','ncPrice','3694288CAquZt','slice','form\x20table\x20~\x20table','pop','#006400','204831FvykKm','classList','querySelector','#dddd77','/quickstock','value','[width=\x22350\x22]'];a0_0x38ed=function(){return _0x4bc74a;};return a0_0x38ed();}function a0_0x285d(_0xdff1aa,_0x238b06){_0xdff1aa=_0xdff1aa-0x18d;const _0x38ed12=a0_0x38ed();let _0x285d2f=_0x38ed12[_0xdff1aa];return _0x285d2f;}(async function(){'use strict';const _0x4c9bf3=a0_0x285d;const _0x4f2716=window[_0x4c9bf3(0x1a8)][_0x4c9bf3(0x1db)];try{if(_0x4f2716['includes'](_0x4c9bf3(0x197))){const _0x137275=document['querySelector'](_0x4c9bf3(0x1cb));Array[_0x4c9bf3(0x1a9)](_0x137275[_0x4c9bf3(0x1af)](_0x4c9bf3(0x1d4)))[_0x4c9bf3(0x1bc)](_0x51d64f=>{const _0x52c85a=_0x4c9bf3;_0x51d64f[_0x52c85a(0x19b)]=_0x52c85a(0x1de);}),_0x137275[_0x4c9bf3(0x1d0)](_0x4c9bf3(0x1bd))[_0x4c9bf3(0x1aa)]='7';const _0x293007=document[_0x4c9bf3(0x1c1)]('td');_0x293007['align']=_0x4c9bf3(0x1a4),_0x293007[_0x4c9bf3(0x1cf)]['add'](_0x4c9bf3(0x19d)),_0x293007[_0x4c9bf3(0x1b0)][_0x4c9bf3(0x1ae)]='center',_0x293007[_0x4c9bf3(0x196)]=_0x4c9bf3(0x1c6),_0x293007[_0x4c9bf3(0x19b)]=_0x4c9bf3(0x1ad);const _0x1d6299=_0x137275['querySelector']('tr')['querySelectorAll']('td')[0x5]||null;_0x137275[_0x4c9bf3(0x1d0)]('tr')[_0x4c9bf3(0x1ac)](_0x293007,_0x1d6299);const _0x41553b=_0x137275['querySelectorAll']('form\x20~\x20tr'),_0x21ef33=Array[_0x4c9bf3(0x1a9)](_0x41553b)[_0x4c9bf3(0x1bc)](_0x57674a=>({'itemName':_0x57674a['querySelectorAll']('td')[0x1]?.[_0x4c9bf3(0x196)]?.[_0x4c9bf3(0x1bb)]('(')?.[0x0],'itemImg':_0x57674a[_0x4c9bf3(0x1af)]('td')[0x0]?.['querySelector'](_0x4c9bf3(0x1bf))?.[_0x4c9bf3(0x19a)],'itemImgId':_0x57674a[_0x4c9bf3(0x1af)]('td')[0x0]?.[_0x4c9bf3(0x1d0)](_0x4c9bf3(0x1bf))?.[_0x4c9bf3(0x19a)]?.[_0x4c9bf3(0x1bb)]('/')[_0x4c9bf3(0x1cc)]()[_0x4c9bf3(0x1bb)]('.')[0x0],'el':_0x57674a}))[_0x4c9bf3(0x1da)](_0x2a3d6e=>_0x2a3d6e[_0x4c9bf3(0x1dc)]),_0xfb6b09=await fetchItemData(_0x21ef33);_0xfb6b09[_0x4c9bf3(0x1b3)](_0x2f82a1=>{const _0x220898=_0x4c9bf3,_0x1aef10=document[_0x220898(0x1c1)]('td');_0x1aef10[_0x220898(0x1b0)][_0x220898(0x1ae)]=_0x220898(0x1b4),_0x1aef10['innerHTML']=_0x2f82a1[_0x220898(0x1c8)]?_0x220898(0x1ba)+_0x2f82a1['ncPrice']+_0x220898(0x1d9):_0x220898(0x1ba)+(_0x2f82a1['price']?formatNumber(_0x2f82a1['price']):'?')+_0x220898(0x191);const _0x3799de=_0x2f82a1['el'][_0x220898(0x1af)]('td')[0x5]||null;_0x2f82a1['el'][_0x220898(0x1ac)](_0x1aef10,_0x3799de);});const _0x30c58=document[_0x4c9bf3(0x1c1)]('td');console[_0x4c9bf3(0x1b1)](_0x30c58),Array['from'](_0x137275[_0x4c9bf3(0x1af)]('tr'))[_0x4c9bf3(0x1cc)]()[_0x4c9bf3(0x18d)](_0x30c58);}else{if(_0x4f2716[_0x4c9bf3(0x19c)]('/auctions')){const _0x32e1fd=document[_0x4c9bf3(0x1d0)]('center\x20+\x20table'),_0x37936c=document[_0x4c9bf3(0x1c1)]('td');_0x37936c[_0x4c9bf3(0x1d6)]=_0x4c9bf3(0x1a4),_0x37936c[_0x4c9bf3(0x1a5)](_0x4c9bf3(0x1c4),_0x4c9bf3(0x1d1)),_0x37936c[_0x4c9bf3(0x1b0)][_0x4c9bf3(0x1ae)]=_0x4c9bf3(0x1a4),_0x37936c['innerHTML']=_0x4c9bf3(0x1d8);const _0x2da53c=_0x32e1fd[_0x4c9bf3(0x1d0)]('tr')[_0x4c9bf3(0x1af)]('td')[0x2]||null;_0x32e1fd['querySelector']('tr')[_0x4c9bf3(0x1ac)](_0x37936c,_0x2da53c);const _0x3e0d98=Array[_0x4c9bf3(0x1a9)](_0x32e1fd[_0x4c9bf3(0x1af)]('tr'))[_0x4c9bf3(0x1ca)](0x1),_0x39f5de=_0x3e0d98[_0x4c9bf3(0x1bc)](_0x51cc59=>({'itemName':_0x51cc59[_0x4c9bf3(0x1af)]('td')[0x2]?.[_0x4c9bf3(0x196)],'itemImg':_0x51cc59[_0x4c9bf3(0x1af)]('td')[0x1]?.[_0x4c9bf3(0x1d0)](_0x4c9bf3(0x1bf))?.[_0x4c9bf3(0x19a)],'itemImgId':_0x51cc59[_0x4c9bf3(0x1af)]('td')[0x1]?.[_0x4c9bf3(0x1d0)](_0x4c9bf3(0x1bf))?.['src']?.[_0x4c9bf3(0x1bb)]('/')[_0x4c9bf3(0x1cc)]()[_0x4c9bf3(0x1bb)]('.')[0x0],'el':_0x51cc59})),_0x16139e=await fetchItemData(_0x39f5de);_0x16139e['forEach'](_0x40b6ac=>{const _0x5f32d8=_0x4c9bf3,_0x22279a=Number(_0x40b6ac['el']['querySelectorAll']('td')[0x6][_0x5f32d8(0x196)]['replace'](/,/g,'')[_0x5f32d8(0x1a7)](_0x5f32d8(0x1d7),''));let _0x9254f7='';if(_0x40b6ac[_0x5f32d8(0x1c7)]===0x0)_0x9254f7=_0x5f32d8(0x19f);else{if(_0x40b6ac[_0x5f32d8(0x1c7)]>_0x22279a)_0x9254f7=_0x5f32d8(0x1cd);else _0x40b6ac[_0x5f32d8(0x1c7)]<_0x22279a&&(_0x9254f7=_0x5f32d8(0x1c5));}console[_0x5f32d8(0x1b1)](_0x22279a);const _0x2913a3=document[_0x5f32d8(0x1c1)]('td');_0x2913a3[_0x5f32d8(0x1b0)][_0x5f32d8(0x1ae)]=_0x5f32d8(0x1b4),_0x2913a3[_0x5f32d8(0x18e)]=_0x5f32d8(0x1ba)+(_0x40b6ac[_0x5f32d8(0x1c7)]?formatNumber(_0x40b6ac[_0x5f32d8(0x1c7)]):'?')+'</b>',_0x2913a3[_0x5f32d8(0x1b0)]['color']=_0x9254f7;const _0x2916cf=_0x40b6ac['el'][_0x5f32d8(0x1af)]('td')[0x3]||null;_0x40b6ac['el'][_0x5f32d8(0x1ac)](_0x2913a3,_0x2916cf);});}else{if(_0x4f2716[_0x4c9bf3(0x19c)](_0x4c9bf3(0x1d2))){const _0x328c91=document['querySelector'](_0x4c9bf3(0x1a3)),_0x63f4cf=document[_0x4c9bf3(0x1c1)]('th');_0x63f4cf[_0x4c9bf3(0x1d6)]=_0x4c9bf3(0x1a4),_0x63f4cf[_0x4c9bf3(0x1b0)][_0x4c9bf3(0x1ae)]=_0x4c9bf3(0x1a4),_0x63f4cf[_0x4c9bf3(0x18e)]=_0x4c9bf3(0x1d8);const _0x578731=_0x328c91[_0x4c9bf3(0x1d0)]('tr')[_0x4c9bf3(0x1af)]('th')[0x1]||null;_0x328c91[_0x4c9bf3(0x1d0)]('tr')[_0x4c9bf3(0x1ac)](_0x63f4cf,_0x578731);const _0x23d4be=Array[_0x4c9bf3(0x1a9)](_0x328c91[_0x4c9bf3(0x1af)]('tr'))[_0x4c9bf3(0x1ca)](0x1),_0x33dc63=_0x23d4be['map'](_0x5da2f6=>({'itemName':_0x5da2f6[_0x4c9bf3(0x1af)]('td')[0x0]?.[_0x4c9bf3(0x196)],'el':_0x5da2f6}))[_0x4c9bf3(0x1da)](_0x5a9904=>_0x5a9904['itemName']!=='\x20'&&_0x5a9904['itemName']!==_0x4c9bf3(0x1be)&&_0x5a9904['itemName']!==_0x4c9bf3(0x194));_0x23d4be[_0x4c9bf3(0x1b3)](_0x42d058=>{const _0x416e70=_0x4c9bf3;if(_0x42d058['querySelectorAll']('td')[0x0]?.[_0x416e70(0x196)]===_0x416e70(0x1be)){const _0xa7f8fb=document[_0x416e70(0x1c1)]('td'),_0x4d8f42=_0x42d058[_0x416e70(0x1af)]('td')[0x1]||null;_0x42d058[_0x416e70(0x1ac)](_0xa7f8fb,_0x4d8f42);}});const _0x41f22a=await fetchItemData2(_0x33dc63);_0x41f22a['forEach'](_0x582842=>{const _0x3a6d98=_0x4c9bf3,_0x9ad4b1=document[_0x3a6d98(0x1c1)]('td');_0x9ad4b1['style'][_0x3a6d98(0x1ae)]=_0x3a6d98(0x1b4),_0x9ad4b1[_0x3a6d98(0x18e)]='<b>'+(_0x582842[_0x3a6d98(0x1c7)]?formatNumber(_0x582842[_0x3a6d98(0x1c7)]):'?')+'</b>';const _0x2803b6=_0x582842['el'][_0x3a6d98(0x1af)]('td')[0x1]||null;_0x582842['el'][_0x3a6d98(0x1ac)](_0x9ad4b1,_0x2803b6);});}}}}catch(_0x3d14fb){console[_0x4c9bf3(0x1b1)](_0x3d14fb);}}());
